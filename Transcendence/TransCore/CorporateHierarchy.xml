<?xml version="1.0" encoding="utf-8"?>

<TranscendenceModule>

<!-- CORPORATE HIERARCHY -->

	<Sovereign UNID="&svCorporate;"
			name=":the Corporate Hierarchy"
			shortName=":the Corporations"
			adjective="Corporate"
			demonym=":a Corporate shareholder(s)"
			alignment="constructive chaos"
			   
			inherit="&unidCommonText;"
			>
			
		<Events>
			<GetGlobalAchievements>
				(append
					;	Crime record
					
					(if (geq (int (objGetData gPlayerShip "corpCrimeSeverity")) 2)
						{
							desc: (typTranslate gType 'textWantedFor { crimeText: (objGetData gPlayerShip 'corpCrime) })
							sectionID: 'criminalRecord
							}
						)
					)
			</GetGlobalAchievements>

			<GetGlobalDockScreen>
				(switch
					; This only applies to corporate hierarchy stations
					(not (objMatches gSource Nil "sTAV +corporateCustoms;"))
						Nil
						
					; If the ship is radioactive then we refuse docking
					(shpIsRadioactive gPlayerShip)
						(if (objHasAttribute gSource "corporateDecon")
							{	screen:&dsCommonwealthDecon;	priority:10		overrideOnly:true	}
							{	screen:&dsRefuseContamination;	priority:10		overrideOnly:true	}
							)
						
					; If the player has committed crimes, then she's in trouble
					(geq (int (objGetData gPlayerShip "corpCrimeSeverity")) 2)
						(switch
							;	If the player has insurance, then insurance pays to
							;	compensate victims of the crime (usually)

							(typGetGlobalData &stInsuranceCompany; 'insured)
								{	screen:&dsInsuranceCriminalLiability;	priority:8		overrideOnly:true	}
							
							;	Otherwise, prison
							{	screen:&dsCorporateImprison;	priority:8		overrideOnly:true	}
							)
						
					Nil
					)
			</GetGlobalDockScreen>
		</Events>
		
		<AttributeDesc>
			<!-- Define item attributes so that the player can see which Corporation 
				created the item. -->
		
			<ItemAttribute label="Assembler"		criteria="* +assemblerCorp;"/>
			<ItemAttribute label="Bushido"			criteria="* +bushido;"/>
			<ItemAttribute label="EI"				criteria="* +ei;"/>
			<ItemAttribute label="Heisenmachines"	criteria="* +heisenmachines;"/>
			<ItemAttribute label="Honoku-Tomashi"	criteria="* +honokuTomashi;"/>
			<ItemAttribute label="Kabuto"			criteria="* +kabuto;"/>
			<ItemAttribute label="Kartal"			criteria="* +kartal;"/>
			<ItemAttribute label="Makayev"			criteria="* +makayev;"/>
			<ItemAttribute label="NAMI"				criteria="* +nami;"/>
			<ItemAttribute label="OmniDefense"		criteria="* +omniDefense;"/>
			<ItemAttribute label="Onorad"			criteria="* +onorad;"/>
			<ItemAttribute label="Pacific Defense"	criteria="* +pacificDefense;"/>
			<ItemAttribute label="Rasiermesser"		criteria="* +rasiermesser;"/>
			<ItemAttribute label="Solon"			criteria="* +solon;"/>
			<ItemAttribute label="Taikon"			criteria="* +taikon;"/>
			<ItemAttribute label="Tenhove"			criteria="* +tenhove;"/>
		</AttributeDesc>

		<Language>
			<Text id="crimeMassDestruction">the mass murder of Corporate citizens</Text>
			<Text id="textWantedFor">Wanted by the Corporate Hierarchy for %crimeText%</Text>
		</Language>
	</Sovereign>

	<SystemMap unid="&smCorporateSpace;"
			displayOn="&smHumanSpace;"
			>
		<TopologyProcessor priority="secondaryColony">
			<System criteria="+commonwealthCore;"	attributes="corporateCore"/>
			<System criteria="+commonwealthSpace;"	attributes="corporateSpace"/>
		</TopologyProcessor>
	</SystemMap>

<!-- STATION TYPES -->

	<!-- Adventurer Outfitters -->

	<StationType UNID="&stAdventurerOutfitters;"
			name=				": Adventurer Outfitters|Adventurer Outfitters"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"8"

			multiHull=			"true"
			armorID=			"&itLightGusokuArmor;"
			hitPoints=			"280"
			regen=              "3"
			fireRateAdj=		"15"
			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"---ru cu--- ----- ----- -----"

				locationCriteria=		"+planetary"
				enemyExclusionRadius=	"50"
				/>

		<Image			imageID="&rsStations6;" imageX="0" imageY="640" imageWidth="128" imageHeight="256"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&itHeavyIonBlaster;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="1d12" 
					criteria=		"a L:1-10; -illegal; -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					enhanced=		"5"
					enhancement=	"=(intHPEnhancement1 gItem)"
					/>
			<RandomItem count="1d12" 
					criteria=		"w L:1-10; -illegal; -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					enhanced=		"5"
					enhancement=	"=(intHPEnhancement1 gItem)"
					/>
			<RandomItem count="1d12" 
					criteria=		"d~w L:1-10; -illegal; -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					enhanced=		"5"
					enhancement=	"=(intCorporateGenerateEnhancement gItem)"
					/>

			<RandomItem count="1d12" 
					criteria=		"u -Specialty; -illegal; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:ru|c|cur"
					/>

			<RandomItem count="2d12" 
					criteria=		"m -Specialty; -illegal; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:ru|c|cur"
					/>

			<RandomItem count="1d6" 
					criteria=		"adu L:1-10; -illegal; -Specialty; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:-|r|cur"
					/>
		</Items>

		<Trade currency="credit">
			<Sell	criteria="m +commonwealth; -premiumAmmo; -defective; -illegal; -notForSale; -notStandard;" priceAdj="100" inventoryAdj="200" levelFrequency="systemLevel:ruc|c|cur"/>
			<Sell	criteria="*NU -defective; -Illegal; -ID; -NotForSale;"	priceAdj="100"/>
			<Buy	criteria="amdNU -Illegal; -ID; -NotForSale;"	priceAdj="50"/>
			<Buy	criteria="ufNU -Illegal; -ID; -NotForSale;"	priceAdj="90"/>
			<Buy	criteria="amdufNU -Illegal; -ID;"				priceAdj="10"/>

			<Refuel			criteria="f +BasicFuel; L:1-9;" priceAdj="100"/>
			<RepairArmor	criteria="a L:1-9;" priceAdj="100"/>
			<ReplaceArmor	criteria="a L:1-10;" priceAdj="110"/>
			<InstallDevice	criteria="d L:1-10;" priceAdj="110"	upgradeInstallOnly="true"/>
			<RemoveDevice	criteria="d L:1-10;" priceAdj="110"	upgradeInstallOnly="true"/>
		</Trade>

		<DockScreens>
			<Main>
				<Panes>
					<Default descID="descWelcome">
						<Actions>
							<Action id="actionDockServices" default="1">
								(rpgDockServices gPlayerShip {
									checkMilitaryID: True
									upgradeInstallOnly: True
									})
							</Action>

							<Action id="actionCommoditiesExchange">
								(scrShowScreen gScreen &dsRPGCommoditiesExchange;)
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>
						</Actions>
					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<DockingPorts>
			<Port x="83"	y="29" />
			<Port x="-83"	y="29" />
			<Port x="97"	y="-9" />
			<Port x="-97"	y="-9" />
			<Port x="84"	y="-72" />
			<Port x="-84"	y="-72" />
			<Port x="30"	y="-111" />
			<Port x="-30"	y="-111" />
		</DockingPorts>

		<Language>
			<Text id="descWelcome">

				Welcome to Adventurer Outfitters! We've been serving mercenaries,
				explorers, and pilgrims since 2311.

			</Text>
		</Language>
	</StationType>

	<!-- Armor Dealer -->

	<StationType UNID="&stArmorDealer;"
			name=				"corporate armor dealer"
			sovereign=			"&svCorporate;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			level=				"4"
			size=				"155"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"160"
			multiHull=			"true"
			regen=				"2"

			explosionType=		"&vtBlastExplosion2;"
			ejectaType=			"&vtWreckEjecta;"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"ccuv- ----- ----- ----- -----"

				locationCriteria=		"+planetary"
				/>

		<Names noArticle="true">Armor United; Brentano Armor; Carbellium Armor Systems;
				Dreadnought Armor; Enterprise Armor Dealer; Full Protection Systems;
				Gargantua Defense Systems; Hellforge Armor; Indomitable Armor Systems;
				Jacob's Armor; Krenel Armors, rce; Loki Defense Systems; Murasaki Armor Corporation;
				Nerling Armor Dealers; Ooro Armors; Pangea Protection Equipment;
				Quen Ho Armor; Ransom Armor Corporation; Sentinel Protection Equipment;
				Tenhove Defense Dealer; Umagahli Armor Systems; Viceroy Armor;
				Wei Chang Armor Dealer; %s Armor Systems</Names>

		<!-- Trade and Items -->

		<Trade currency="credit">
			<Sell	criteria="*NU -defective; -Illegal; -ID; -NotForSale;"	priceAdj="100"/>
			<Buy	criteria="asU -Illegal; -NotForSale;"	priceAdj="50"/>
			<Buy	criteria="asU -Illegal; -ID;"				priceAdj="10"/>
			
			<RepairArmor	criteria="a L:1-7;" priceAdj="100"/>
			<ReplaceArmor	criteria="a L:1-7;" priceAdj="100"/>
			<InstallDevice	criteria="s L:1-7;" priceAdj="100"	upgradeInstallOnly="true"/>
			<RemoveDevice	criteria="s L:1-7;" priceAdj="100"	upgradeInstallOnly="true"/>
		</Trade>

		<Items>
			<RandomItem count="8-12" 
					criteria=		"as L:1-7; -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:u|c|ur"
					enhanced=		"10"
					enhancement=	"=(intHPEnhancement1 gItem)"
					/>
			<RandomItem count="8-12" 
					criteria=		"as L:1-7; -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:-|u|cur"
					enhanced=		"5"
					enhancement=	"=(intHPEnhancement1 gItem)"
					/>
			<RandomItem count="6-10" 
					criteria=		"as L:1-7; -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					/>
			<RandomItem count="4" 
					criteria=		"u +ArmorRepair; -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:uc|c|cur"
					/>

			<Item count="3d4"	item="&itAblativeArmorCoating;" />
			<Item count="1d2"	item="&itMonopoleDeflector;" />

			<Item chance="70" count="1d4"	item="&itCarbonWeaverNanos;" />
			<Item chance="10" count="1d4"	item="&itDegeneratingNanos;" />
			<Item chance="70" count="1d4"	item="&itReactiveArmorCoating;" />
			<Item chance="30" count="1d2"	item="&itReflectiveArmorCoating;" />
			<Item chance="10" count="1d2"	item="&itRegeneratingNanos;" />
			<Item chance="30" count="1d4"	item="&itEMPImmuneCoating;" />
		</Items>

		<!-- Configuration -->

		<!-- Satellites -->

		<!-- Ships and Defenses -->

		<Ships standingCount="3">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Ships>

		<!-- Image and Effects -->

		<Image			imageID="&rsCorporateArmorDealer;" imageWidth="160" imageHeight="240" viewportRatio="0.03"/>

		<DockingPorts
				portCount=		"8"
				portAngle=		"15"
				portRadius=		"110"
				>
		</DockingPorts>
		
		<!-- Dock Screens -->

		<DockScreens>
			<Main>
				<Panes>
					<Default descID="descWelcome">
						<Actions>
							<Action name="Armor and Shields" key="A" default="1">
								(scrShowScreen gScreen &dsRPGManageArmor; {
									checkMilitaryID: True
									upgradeInstallOnly: True
									})
							</Action>
							
							<Action id="actionCommoditiesExchange">
								(scrShowScreen gScreen &dsRPGCommoditiesExchange;)
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>

						</Actions>

					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<!-- Events and Behavior -->

		<StaticData>
			<NPCService>
				(	;	service					level	margin
					(	'repairArmor			7		100		)
					)
			</NPCService>
		</StaticData>

        <Language>
			<Text id="descWelcome">
				You are docked at an armor dealer station.
			</Text>
			<Text id="rpg.stationWillNotBuy">

				%StationName% buys armor and shields (even if damaged). We are not 
				interested in buying %itemName%.

			</Text>

            <Text id="core.mapDesc">"Buys and sells armor and shields &mdash; Installs purchased items &mdash; Buys damaged armor and shields"</Text>
        </Language>
	</StationType>

	<!-- Level 4: Arms Dealer -->

	<StationType UNID="&stArmsDealer;"
			name=				"corporate arms dealer"
			sovereign=			"&svCorporate;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			level=				"4"
			size=				"149"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"160"
			multiHull=			"true"
			regen=				"2"

			explosionType=		"&vtBlastExplosion2;"
			ejectaType=			"&vtWreckEjecta;"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"uccr- ----- ----- ----- -----"

				locationCriteria=		"+planetary"
				/>

		<Names noArticle="true">Azure Protection Systems; Bixbie Arms; Chiba Arms Dealers; 
				Dreadnought Arms; Excimer Systems; Farside Defense Systems;
				General Arms, rce; Hastur Weapons; Iberian Defense Systems;
				Jacob's Arms; Kraken Weapons, rce; Laser Armada; Ming Systems;
				Nrummer Weapons Corp.; Obelisk Weapons; Penitent Defender;
				Quixote Arms Corporation; Raptor Systems, rce; Security Weapons;
				Tenhove Defense Dealer; Ultimate Weapons; Victory Systems;
				Weapons World; %s Weapon Systems</Names>

		<!-- Trade and Items -->

		<Trade currency="credit">
			<Sell	criteria="m +commonwealth; +basicAmmo; -defective; -illegal; -notForSale; -notStandard;" priceAdj="100" inventoryAdj="200" levelFrequency="systemLevel:ruc|c|cur"/>
			<Sell	criteria="*NU -defective; -Illegal; -ID; -NotForSale;"	priceAdj="100"/>
			<Buy	criteria="mwU -Illegal; -NotForSale;"	priceAdj="50"/>
			<Buy	criteria="mwU -Illegal; -ID;"				priceAdj="10"/>
			
			<InstallDevice	criteria="w L:1-6;" priceAdj="100"	upgradeInstallOnly="true"/>
			<RemoveDevice	criteria="w L:1-6;" priceAdj="100"	upgradeInstallOnly="true"/>
		</Trade>

		<Items>
			<RandomItem count="10" 
					criteria=		"w L:1-6; -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:-|c|ur"
					enhanced=		"10"
					enhancement=	"=(intHPEnhancement2 gItem)"
					/>
			<RandomItem count="15" 
					criteria=		"w L:1-6; -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|ur"
					enhanced=		"10"
					enhancement=	"=(intHPEnhancement1 gItem)"
					/>
			<RandomItem count="8" 
					criteria=		"w L:1-6; -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					enhanced=		"5"
					enhancement=	"=(intHPEnhancement1 gItem)"
					/>

			<RandomItem count="25-35" 
					criteria=		"m -Illegal; -Military; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:ru|c|ur"
					/>
		</Items>

		<!-- Configuration -->

		<!-- Satellites -->

		<!-- Ships and Defenses -->

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<!-- Image and Effects -->

		<Image			imageID="&rsCorporateArmsDealer;" imageWidth="148" imageHeight="226" viewportRatio="0.03125"/>

		<DockingPorts
				portCount=		"8"
				portAngle=		"-15"
				portRadius=		"100"
				>
		</DockingPorts>
		
		<!-- Dock Screens -->

		<DockScreens>
			<Main>
				<Panes>
					<Default descID="descWelcome">
						<Actions>
							<Action id="actionWeapons" default="1">
								(scrShowScreen gScreen &dsRPGManageWeapons; {
									checkMilitaryID: True
									upgradeInstallOnly: True
									})
							</Action>

							<Action id="actionCommoditiesExchange">
								(scrShowScreen gScreen &dsRPGCommoditiesExchange;)
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>
						</Actions>
					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<!-- Events and Behavior -->

        <Language>
			<Text id="actionWeapons">[W]eapons</Text>

			<Text id="descWelcome">
				You are docked at an arms dealer station.
			</Text>
			<Text id="rpg.stationWillNotBuy">

				%StationName% buys weapons (even if damaged). We are not 
				interested in buying %itemName%.

			</Text>

            <Text id="core.mapDesc">
				Buys and sells weapons and ammo &mdash; Installs purchased items &mdash; Buys damaged weapons
			</Text>
        </Language>
	</StationType>

	<!-- Arms Dealer, Bushido -->

	<StationType UNID="&stArmsDealerBushido;"
			name=				"Bushido merchant"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"&dsArmsDealerSpecial;"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			multiHull=			"true"
			armorID=			"&itLightGusokuArmor;"
			hitPoints=			"300"
			regen=				"4"
			fireRateAdj=		"20"
			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"---ru rv--- ----- ----- -----"

				locationCriteria=		"+planetary"
				enemyExclusionRadius=	"50"
				/>

		<Image			imageID="&rsCorporateArmsDealer;" imageWidth="148" imageHeight="226" viewportRatio="0.03125"/>

		<DockingPorts
				portCount=		"8"
				portAngle=		"-15"
				portRadius=		"100"
				>
		</DockingPorts>
		
		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&itNeutronBlaster;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="1d12" 
					criteria=		"w L:1-10; +Bushido; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					enhanced=		"10"
					enhancement=	"=(intBushidoWeaponEnhancement gItem)"
					/>

			<RandomItem count="1d12" 
					criteria=		"s L:1-10; +Bushido; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					enhanced=		"10"
					enhancement=	"=(intBushidoShieldEnhancement)"
					/>

			<RandomItem count="1d12" 
					criteria=		"a L:1-10; +Bushido; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					enhanced=		"10"
					enhancement=	"=(intBushidoArmorEnhancement)"
					/>

			<RandomItem count="1d12" 
					criteria=		"a L:1-10; +Bushido; -NotForSale;"
					levelFrequency=	"systemLevel:r|u|cur"
					enhanced=		"5"
					enhancement=	"=(intBushidoArmorEnhancement)"
					/>
		</Items>

		<Trade currency="credit">
			<Sell	criteria="m +bushido; -defective; -illegal; -notForSale;" priceAdj="100" inventoryAdj="300" levelFrequency="systemLevel:ruc|c|cur"/>
			<Sell	criteria="*NU -defective; -Illegal; -ID; -NotForSale;"	priceAdj="100"/>

			<RepairArmor	criteria="a L:1-9;" priceAdj="100"/>
			<ReplaceArmor	criteria="a +bushido; L:1-10;" priceAdj="100"/>
			<InstallDevice	criteria="d +bushido; L:1-10;" priceAdj="100"/>
			<RemoveDevice	criteria="d L:1-10;" priceAdj="100"/>
			
			<ReplaceArmor	criteria="a L:1-10;" priceAdj="unavailable"	messageID="descNoInstall"/>
			<InstallDevice	criteria="d L:1-10;" priceAdj="unavailable"	messageID="descNoInstall"/>
		</Trade>

		<StaticData>
			<LongName>"a Bushido arms dealer"</LongName>
		</StaticData>

		<Language>
			<Text id="descNoInstall">

				We only install Bushido items. We cannot install %itemName% on 
				your ship.

			</Text>
			<Text id="dockServices:installAbility">

				We install Bushido items up to tech level %maxLevel%.

			</Text>

			<Text id="core.mapDesc">

				Repairs armor up to level 9 &mdash;
				Installs Bushido armor up to level 10 &mdash;
				Installs Bushido devices up to level 10 &mdash;
				Sells Bushido products

			</Text>
		</Language>

	</StationType>

	<!-- Auton Dealer -->

	<StationType UNID="&stAutonDealer;"
			name=				"corporate auton dealer"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"8"

			multiHull=			"true"
			armorID=			"&itAdvancedPlasteelPlate;"
			hitPoints=			"350"
			regen=				"4"
			explosionType=		"&vtBlastExplosion2;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"--rcu ur--- ----- ----- -----"

				locationCriteria=		"+planetary"
				enemyExclusionRadius=	"50"
				/>

		<Names noArticle="true">Auton Universe; Brehzen's Used Autons; Chiba Auton Dealers;
				Dresden Autonomous Defenders; Ehrlenmeyer Autons; Frenzy Autons;
				General Autons, rce; Hastur Used Autons; Ixin Autons Dealer;
				Ji Autons; Kyrrin Used Autons; Laser Autons, rce; Merlin Autons;
				Nrummer Weapons Corp.; Oort Autons, rce; Planetary Autons;
				Qing Long Autons; Raptor Systems, rce; Security Autons;
				Tenhove Defense Dealer; Ultimate Autons; Victory Systems;
				Weapons World; %s Auton Dealers</Names>

		<Image			imageID="&rsStations4;" imageX="128" imageY="192" imageWidth="128" imageHeight="256"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Items>
			<RandomItem count="20" 
					criteria=		"* +auton; -illegal; -military; -notStandard; -notForSale;"
					levelFrequency=	"systemLevel:ucc|c|cur"
					/>
			<RandomItem count="1d6" 
					criteria=		"* +auton; -illegal; -military; -notStandard; -notForSale; L:4"
					/>
		</Items>

		<Trade currency="credit">
			<Sell	criteria="*NU -defective; -Illegal; -ID; -NotForSale;"	priceAdj="100"/>
			<Buy	criteria="*NU +Auton; -Illegal; -NotForSale;"	priceAdj="90"/>
		</Trade>

		<DockScreens>
			<Main>
				<Panes>
					<Default descID="descWelcome">
						<Actions>
							<Action name="Buy Autons" default="1" key="B">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy;)
							</Action>

							<Action name="Sell Autons" key="S">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell;)
							</Action>

							<Action name="Repair Active Autons" key="R">
								(block Nil
									; Figure out the list of autons for the player
									(setq gList (sysFindObject gPlayerShip "s B:auton; O:escort;"))
									(if gList
										(scrShowPane gScreen "RepairAutons")
										(scrShowPane gScreen "NoAutons")
										)
									)
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>

						</Actions>

					</Default>

					<NoAutons descID="descNoAutons">
						<Actions>
							<Action id="actionLeave" cancel="1" default="1">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</NoAutons>

					<RepairAutons>
						<OnPaneInit>
							(block Nil
								; Figure out how much it would cost to repair the player's
								; autons.

								(setq gCost 0)
								(enum gList auton
									(for i 0 (subtract (shpGetArmorCount auton) 1)
										(setq gCost (add gCost (multiply 5 (objGetArmorDamage auton i))))
										)
									)

								(switch
									; If the autons have no damage, then there is nothing to do
									(eq gCost 0)
										(block Nil
											(scrSetDesc gScreen "There is no damage to your autons.")
											(scrEnableAction gScreen 0 Nil)
											)

									; If the player cannot afford it.
									(gr gCost (plyGetCredits gPlayer))
										(block Nil
											(scrSetDesc gScreen (cat "Repairing the damage to your autons would cost " gCost " credits. Unfortunately, you do not have enough credits to proceed."))
											(scrEnableAction gScreen 0 Nil)
											)

									; Otherwise, we're OK
									(scrSetDesc gScreen (cat "Repairing the damage to your autons will cost " gCost " credits. Do you wish to proceed?"))
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Repair" default="1" key="R">
								(block Nil
									(enum gList auton
										(for i 0 (subtract (shpGetArmorCount auton) 1)
											(objRepairArmor auton i)
											)
										)

									(plyCharge gPlayer gCost)
									(scrShowPane gScreen "Default")
									)
							</Action>

							<Action id="actionLeave" cancel="1">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</RepairAutons>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="90" />
			<Port x="0"		y="-90" />
			<Port x="60"	y="60" />
			<Port x="60"	y="-60" />
			<Port x="90"	y="0" />
			<Port x="-90"	y="0" />
			<Port x="-60"	y="60" />
			<Port x="-60"	y="-60" />
		</DockingPorts>

        <Language>
			<Text id="descWelcome">
				You are docked at an auton dealer.
			</Text>
			<Text id="descNoAutons">

				A sales drone approaches you:
				
				"You do not currently have any autons to repair, but I would be 
				delighted to show you some of our newest models."

			</Text>
			<Text id="rpg.stationWillNotBuy">

				%StationName% buys autons. We are not 
				interested in buying %itemName%.

			</Text>
            <Text id="core.mapDesc">"Buys and sells autons"</Text>
        </Language>
	</StationType>

	<!-- Level 4: Corporate Enclave -->

	<StationType UNID="&stCorporateEnclave;"
			name=				"corporate enclave"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			attributes=			"corporate, corporateCustoms, friendly, independent, generic, human, majorStation, populated"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			level=				"4"
			size=				"430"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"320"
			multiHull=			"true"
			regen=              "6"

			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"+corporateCore;"
				levelFrequency=			"ruuur ----- ----- ----- -----"

				locationCriteria=		"-asteroids"
				enemyExclusionRadius=	"50"
				/>

		<!-- Trade and Items -->

		<Trade currency="credit">
			<Buy	criteria="*NU +Lux; -Illegal;"	priceAdj="105"/>
			<Buy	criteria="*NU +Meds; -Illegal;"	priceAdj="105"/>
			<Buy	criteria="*NU +Food; -Illegal;"	priceAdj="105"/>
			<Buy	criteria="*NU +Res; -Illegal;"	priceAdj="105"/>

			<ConsumeTrade	criteria="{core.fusionFuel}"		impact="5"/>
			<ConsumeTrade	criteria="{human.res}"		impact="3"/>
			<ConsumeTrade	criteria="{core.ore}"			impact="3"/>

			<ProduceTrade	criteria="{human.lux}"		impact="5"/>
		</Trade>

		<!-- Ships and Defenses -->

		<Ships>
			<Lookup count="1d4+2" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<!-- Image and Effects -->

		<Image			imageID="&rsCorporateEnclave;" imageWidth="320" imageHeight="540" viewportRatio="0.0277"/>

		<DockingPorts
				portCount=		"10"
				portRadius=		"175"
				>
		</DockingPorts>
		
		<!-- Dock Screen -->

		<DockScreens>
			<Main>
				<Panes>
					<Default descID="descWelcome">
						<Actions>
							<Action name="Corporate Level" default="1" key="C">
								<Navigate screen="CorporateLevel" />
							</Action>

							<Action name="Residential Level" key="R" id="residentialLevel">
								<ShowPane pane="ResidentialLevel"/>
							</Action>

							<Action name="Maintenance Level" key="M">
								(if (objGetItems gPlayerShip "*NU +Illegal; -ID; +property:known;")
									(scrShowPane gScreen "Illegals")
									(scrShowPane gScreen "MaintenanceLevel")
									)
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>

						</Actions>

					</Default>

					<Illegals descID="descIllegals">
						<Actions>
							<Action name="Enter Maintenance Shop" default="1" key="E">
								<ShowPane pane="MaintenanceShop"/>
							</Action>

							<Action id="actionLeave" cancel="1">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</Illegals>

					<MaintenanceLevel descID="descMaintenanceLevel">
						<Actions>
							<Action id="actionLeave" default="1" cancel="1">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</MaintenanceLevel>

					<MaintenanceShop descID="descMaintenanceShop">
						<Actions>
							<Action name="&quot;Sorry, you have me confused with someone else.&quot;" cancel="1" key="S">
								<ShowPane pane="Illegals"/>
							</Action>

							<Action name="&quot;The merchandise is in my cargo hold.&quot;" default="1" key="M">
								(block (
									;	Price depends on whether a Black Market station 
									;	is in the system.

									(priceAdj
										(switch
											(sysFindObject Nil "TA +blackMarket; +populated;")
												90

											110
											)
										)
									)
									(scrShowPane gScreen "Default")
									
									(scrShowSellScreen
										(lambda (theItem)
											(switch
												(itmMatches theItem "*NU +Illegal; -ID; +property:known;")
													(divide (multiply priceAdj (itmGetPrice theItem 'credit)) 100)
													
												Nil
												)
											)
								
										Nil						; obsolete
										
										'(
											Nil
											50000
											)
										)
									)
							</Action>
						</Actions>
					</MaintenanceShop>

					<ResidentialLevel descID="descResidentialLevel">
						<Actions>
							<Action id="actionLeave" default="1" cancel="1">
								<ShowPane pane="Default"/>
							</Action>
						</Actions>
					</ResidentialLevel>

				</Panes>
			</Main>

			<CorporateLevel>
				<Panes>
					<Default descID="descCorporateLevel">
						<Actions>
							<Action id="actionSellItems" default="1">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell;)
							</Action>

							<Action id="actionLeave" cancel="1">
								<Navigate screen="Main" />
							</Action>
						</Actions>
					</Default>

				</Panes>

			</CorporateLevel>

		</DockScreens>

		<!-- Events and Data -->

        <Language>
			<Text id="descWelcome">

				You are in the docking level of a corporate enclave. The 
				citizens of the station work for various members of the 
				Corporate Hierarchy.

			</Text>
			<Text id="descMaintenanceLevel">

				You are in the maintenance level of a corporate enclave. The 
				drone of the atmosphere processors and the waste converters 
				drowns out all other noises.
				
				There is an empty maintenance shop here filled with various 
				machines and drones; an empty laudanum ampule peeks out from 
				under the workbench.

			</Text>
			<Text id="descIllegals">

				You are in the maintenance level of a corporate enclave. The 
				door to the maintenance shop is open and you hear voices inside.

			</Text>
			<Text id="descMaintenanceShop">
				
				You are in the maintenance shop surrounded by various machines 
				and drones. There are four men in the room repairing various 
				items.
				
				One of the men walks towards you and says, "You must be the new 
				delivery person. Show me what you've got to sell."

			</Text>
			<Text id="descResidentialLevel">

				You are in the residential level of a corporate enclave. This 
				level holds the apartments and dwelling units of mid-level 
				corporate citizens. The units are small and somewhat homogenous,
				though everyone you meet seems happy.

			</Text>
			<Text id="descCorporateLevel">

				You are in the corporate level of a corporate enclave. The 
				day-to-day services and manufacturing of the various 
				corporations are carried out on this level.

			</Text>
			<Text id="rpg.stationWillNotBuy">

				%StationName% buys food, luxuries, meds, and industrial 
				resources. We are not interested in buying %itemName%.

			</Text>
            <Text id="core.mapDesc">"Buys food, luxuries, meds, and industrial resources"</Text>
        </Language>
	</StationType>

	<!-- Fuel Depot -->

	<StationType UNID="&stFuelDepot;"
			name=				"corporate fuel depot"
			sovereign=			"&svCorporate;"

			attributes=			"corporate, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			level=				"4"
			size=				"184"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"160"
			multiHull=			"true"
			regen=              "2"

			explosionType=		"&vtThermoExplosion3;"
			ejectaType=			"&vtWreckEjecta;"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"cccuu rv--- ----- ----- -----"

				locationCriteria=		"-outerSystem, +planetary"
				/>

		<Names noArticle="true">Antares Fuel; Bapco Fuel; Cerulean Energy;
				Dilithium Fuels, rce; Energy Supplies, rce; Fentano Fuels;
				Gargantua Fuel Systems; Herenix Fuel &amp; Energy; Impala Refueling;
				Jerry's Ship Fuel; Konstantine Fuels; Lexi Starship Fuels; Miranda Fueling Depot;
				Ngari Fuels; Otomo Fuels; Pergium Fuel &amp; Supplies;
				Qi jin Fuels; Revenant Fuels; Sanchez Fuel;
				Tander Fuel &amp; Energy; Urion Fuels; Vanderberg Fuels;
				Wehesaken Fuel Depot; %s Fuel</Names>

		<!-- Trade and Items -->

		<Trade currency="credit">
			<Sell	criteria="fNU +basicFuel; L:1-4; -defective; -illegal; -ID; -notForSale;"	priceAdj="90"/>
			<Sell	criteria="*NU -defective; -Illegal; -ID; -NotForSale;"	priceAdj="100"/>

			<Refuel			criteria="f +BasicFuel; L:1-4;" priceAdj="90"/>
			<Refuel			criteria="f +BasicFuel; L:5-10;" priceAdj="100"/>

			<ProduceTrade	criteria="{core.fusionFuel}"		impact="20"/>
		</Trade>

		<Items>
			<LevelTable count="1d3">
				<Item levelFrequency="cccur v----"	count="4d20"	item="&itHelium3FuelRod;" />
				<Item levelFrequency="-rucc urv--"	count="4d20"	item="&itHeliumAssembly;" />
				<Item levelFrequency="--ruc curv-"	count="4d20"	item="&itXenotiteFuelRod;" />
				<Item levelFrequency="----r uccur"	count="4d20"	item="&itPteracniumFuelRod;" />
				<Item levelFrequency="----- -rucc"	count="4d20"	item="&itHadronVacuumFuelCell;" />
			</LevelTable>
			
			<Item				count="4d20"	item="&itWaterIce;" />
			<Item chance="50"	count="2d20"	item="&itHydrogenGas;" />
			<Item chance="50"	count="2d20"	item="&itLiquidOxygen;" />
			<Item chance="50"	count="1"		item="&itSystemMapROM;" />
		</Items>

		<!-- Configuration -->

		<!-- Satellites -->

		<!-- Ships and Defenses -->

		<Ships>
			<Lookup count="1d2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="3">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<!-- Image and Effects -->

		<Image imageID="&rsCorporateFuelDepot;" imageWidth="186" imageHeight="240" viewportRatio="0.03"/>

		<DockingPorts
				portCount=		"12"
				portAngle=		"15"
				portRadius=		"120"
				>
		</DockingPorts>

		<!-- Dock Screens -->
		
		<DockScreens>
			<Main>
				<Panes>
					<Default>
						<OnPaneInit>
							(block (actionStatus)
								(scrSetDescTranslate gScreen 'desc { name:(objGetName gSource) })
								
								(setq actionStatus (rpgCalcDockServiceRefuelAction gSource gPlayerShip { }))
								(scrShowAction gScreen 'actionRefuel (@ actionStatus 'visible))
								(scrEnableAction gScreen 'actionRefuel (@ actionStatus 'enabled))
								(scrSetActionDesc gScreen 'actionRefuel (@ actionStatus 'desc))
								)
						</OnPaneInit>

						<Actions>
							<Action id="actionRefuel" default="1">
								(scrShowScreen gScreen "&dsRPGRefuel;")
							</Action>

							<Action id="actionBuyItems">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy;)
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>
						</Actions>
					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<!-- Events and Behavior -->

		<Language>
			<Text id="desc">

				Welcome to %name%, your most reliable source of starship fuel 
				and a member of the Earth Industries Conglomerate.

				All our fuel has been produced to the exacting standards 
				required by today's reactors. Please use the terminal to proceed 
				with your transaction.

			</Text>
            <Text id="core.mapDesc">
                Refuels up to level 10 &mdash; Sells fuel and supplies
            </Text>
		</Language>

	</StationType>

	<!-- Manufacturing Plant
	
	EXTRA DATA

	itemsConsumed:		List of item types that we consume
	buyItemsList:		String listing items that we want to buy
	itemsCreated:		List of item types that we create
	maxInventory:		Max credits worth of items to stock	
	
	-->

	<StationType UNID="&stManufacturingPlant;"
			name=				"corporate manufacturing plant"
			sovereign=			"&svCorporate;"

			attributes=			"corporate, corporateCustoms, friendly, independent, generic, human, majorStation, populated"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			size=				"325"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"630"
			multiHull=			"true"
			regen=              "6"

			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"
			>
			
		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"+corporateCore;"
				levelFrequency=			"-uuuu r---- ----- ----- -----"

				locationCriteria=		"-planetary"
				enemyExclusionRadius=	"75"

				unique=					"inSystem"
				/>

		<Names noArticle="true">Arcoter Industrials; Bosen-Haggen Manufacturing; Cloud9 Industrials;
			Dai-chi Plant %1%0; Electrox Manufacturing; Fahrenheit Technologies; Geotron Industries;
			Honoku-Tomashi Plant %1%0%0; Irene Sanchez Factory; Jorrell Scientific Plant %1%0%0;
			Kestrel Industrials; Lamar Industries; Marina-Maxwell Factory %1%0%0; Nordic Industrials;
			Oceana Manufacturing; Blue Planet Facility %1%0%0; Reich &amp; Balham Plant %1%0%0;
			Senpaku Hogei Manufacturing; Thalmann Industries; Ursa Majoris Manufacturing;
			Ventabot Manufacturing; WIZ Manufacturing; Yollensgard Industrials; Z%1 Manufacturing
		</Names>

		<!-- Trade and Items -->

		<Trade currency="credit">
		</Trade>

		<!-- Ships and Defenses -->

		<Ships>
			<Lookup count="1d4+2" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<!-- Image and Effects -->

		<Image			imageID="&rsCorporateManufacturing;" imageWidth="270" imageHeight="560" viewportRatio="0.02125"/>

		<DockingPorts
				portCount=		"12"
				portAngle=		"-15"
				portRadius=		"145"
				>
		</DockingPorts>

		<!-- Dock Screens -->

		<DockScreens>
			<Main>
				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDescTranslate gScreen 'descWelcome {
								buyItemsList: (objTranslate gSource 'buyItemsList)
								})
						</OnPaneInit>

						<Actions>
							<Action id="actionBuyItems" default="1">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy;)
							</Action>
							
							<Action id="actionSellItems">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell;)
							</Action>
							
							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>
						</Actions>
					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<!-- Events and Behavior -->
		
		<Events>
			<OnCreate>
				(block (
					;	We have different kinds of manufacturing plants

					(allTypes (list

						;	Food Manufacturing

						{
							produces: "t +food; -lux; -res; -fuel; -ID; -illegal; -art; -antique; -alien; -notForSale; F:curv; &gt;$0 &lt;=$500 &lt;=6"
							consumes: "t +res; -ore; -illegal; -notForSale; F:curv; &lt;=$250"

							tradeProd: "{human.basicFood}"
							tradeCons: "{human.res}"
							}

						;	Luxury Manufacturing

						{
							produces: "t +lux; -res; -fuel; -ID; -illegal; -art; -antique; -alien; -notForSale; F:curv; &gt;$0 &lt;=$500 &lt;=6"
							consumes: "t +res; -ore; -illegal; -notForSale; F:curv; &lt;=$500"

							tradeProd: "{human.lux}"
							tradeCons: "{human.res}"
							}

						;	Industrial Resource Manufacturing

						{
							produces: "t +res; -ore; -fuel; -ID; -illegal; -art; -antique; -alien; -notForSale; F:curv; &gt;$0 &lt;=$500 &lt;=6"
							consumes: "t +ore; -illegal; -notForSale; F:cu; &lt;=$250"

							tradeProd: "{human.res}"
							tradeCons: "{core.ore}"
							}
						))

					;	Pick a random type

					(facDesc (random allTypes))

					(maxInventory (multiply (random 1000 2000) (sysGetLevel)))

					allItems itemsCreated itemsConsumed totalItems
					)

					;	Pick the items that we manufacture

					(setq allItems (shuffle (itmGetTypes (@ facDesc 'produces))))
					(setq totalItems (min (random 3 5) (count allItems)))
					(for i 1 totalItems
						(block (theType thePrice theCount)
							(setq theType (item allItems (subtract i 1)))
							(setq itemsCreated (append itemsCreated theType))
							
							; Create items
							(setq theCount (divide maxInventory (itmGetPrice (itmCreate theType 1) 'credit)))
							(objAddItem gSource	(itmCreate theType theCount))
								
							; Set trade line
							(objAddSellOrder gSource theType (random '(50 70 80 80 85 85 85 85 90)))
							)
						)
						
					;	Pick the items that we consume
					
					(setq allItems (shuffle (itmGetTypes (@ facDesc 'consumes))))
					(setq itemsConsumed (subset allItems 0 (random 2 4)))
					(enum itemsConsumed theType
						(objAddBuyOrder gSource theType (random '(150 130 120 120 115 115 115 110)))
						)

					;	Add trade orders for system-wide price impacts

					(objAddTradeOrder gSource 'produceTrade (@ facDesc 'tradeProd) 10)
					(objAddTradeOrder gSource 'consumeTrade (@ facDesc 'tradeCons) 10)

					;	Remember some values

					(objSetData gSource 'itemsCreated itemsCreated)
					(objSetData gSource 'itemsConsumed itemsConsumed)
					(objSetData gSource 'maxInventory maxInventory)
					
					;	Register a timer so that we can resupply

					(sysAddObjRecurringTimerEvent 9000 gSource "OnManufacture")
					)
			</OnCreate>

			<OnManufacture>
				(block (totalConsumed manufactureRun)
					; Consume raw materials (and keep track of how much we are consuming)
					(setq totalConsumed 0)
					(enum (objGetItems gSource "*U +Res;") theItem
						(block Nil
							(setq totalConsumed (add totalConsumed (multiply (itmGetPrice theItem 'credit) (itmGetCount theItem))))
							(objRemoveItem gSource theItem)
							)
						)
						
					; Manufacture
					(setq manufactureRun (divide totalConsumed 5))
					(if (gr totalConsumed 0)
						(for i 1 5
							(block (theType theCount)
								(setq theType (random (objGetData gSource "itemsCreated")))
								(setq theCount (divide manufactureRun (itmGetPrice (itmCreate theType 1) 'credit)))
								(objAddItem gSource (itmCreate theType (max 1 theCount)))
								)
							)
						)
					)
			</OnManufacture>
		</Events>

        <Language>
			<Text id="descWelcome">

				You are in the docking level of a corporate manufacturing plant.
				The station master greets you:

				"Welcome to our manufacturing facilities! We are looking to buy %buyItemsList%."

			</Text>
			
			<Text id="buyItemsList">
				(or (objGetData gSource 'buyItemsList)
					(block (itemsConsumed buyItemsList)
						(setq itemsConsumed (objGetData gSource 'itemsConsumed))
						
						;	Fix stations that were created while the OnCreate event was partially broken.
						
						(if (not itemsConsumed) (objSetData gSource 'itemsConsumed (setq itemsConsumed
							(map (itmGetTypes '*) '(excludeNil original) theType
								(objGetBuyPrice gSource (itmCreate theType 1))
								)
							)))
							
						(setq buyItemsList (join (map itemsConsumed theType 
													(itmGetName theType '(plural short))
													)
												'oxfordComma
												))
						(objSetData gSource 'buyItemsList buyItemsList)
						buyItemsList
						)
					)
			</Text>

            <Text id="core.mapDescCustom">
                (typTranslate gType 'mapDescCustomText {
					buyItemsList: (objTranslate gSource 'buyItemsList)
					sellItemsList: (join (map (objGetData gSource 'itemsCreated) theType
											(itmGetName theType '(plural short))
											)
										'oxfordComma
										)
					})
            </Text>
			
			<Text id="mapDescCustomText">
				Buys %buyItemsList% &mdash;
				Sells %sellItemsList%
			</Text>
        </Language>
	</StationType>

	<!-- Merchant Prince Hotel -->

	<StationType UNID="&stHotel;"
			name=				"corporate hotel"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			level=				"4"
			multiHull=			"true"
			armorID=			"&itCeralloyArmor;"
			hitPoints=			"160"
			regen=				"4"
			explosionType=		"&vtBlastExplosion2;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, majorStation, populated"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"uuurr v---- ----- ----- -----"

				locationCriteria=		"*"
				unique=					"inSystem"
				/>

		<Names definiteArticle="true">Beta Gemini Hotel; Honoku-Tomashi Hotel; Manchurian Oriental Hotel;
				Merchant Prince Hotel; Savanna Hotel; Seven Sisters Hotel;
				Virgin %s Hotel; %s Interstellar Hotel</Names>

		<Image			imageID="&rsStations2;" imageX="0" imageY="256" imageWidth="192" imageHeight="256"/>

		<Ships>
			<Lookup count="1d2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Trade currency="credit">
			<Buy	criteria="*NU +Lux; -Illegal;"	priceAdj="105"/>
			<Buy	criteria="*NU +Food; -Illegal;"	priceAdj="105"/>
			<Buy	criteria="*NU" item="&itWaterIce;"		priceAdj="105"/>
			<Buy	criteria="*NU" item="&itStimuzine;"		priceAdj="105"/>
			<Buy	criteria="*NU" item="&itMedicalSupplies;"		priceAdj="105"/>
			<Buy	criteria="*NU" item="&itBiofactorPaste;"		priceAdj="105"/>
			<Buy	criteria="*NU" item="&itHypermycin;"		priceAdj="105"/>

			<ConsumeTrade	criteria="{core.fusionFuel}"		impact="2"/>
			<ConsumeTrade	criteria="{human.lux}"		impact="5"/>
		</Trade>

		<Events>
			<GetRumors>
				{
					attributes: "commonwealthPub"
					priority: 24
					textID: 'rumor.commonwealthPub
					data: {station: (objGetName gSource)}
					onExitRumor: (lambda (theRumor) (objSetKnown (@ theRumor 'sourceObj)))
					}
			</GetRumors>
		</Events>

		<DockScreens>
			<Main>
				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen (cat "Welcome to " (objGetName gSource 4) "."))
						</OnPaneInit>

						<Actions>
							<Action id="actionRestaurant">
								(rpgMissionAssignment {
									missionCriteria: (cat "n +corporateHotel; =" (sysGetLevel) ";")
									noMissionTextID:
										(if (objGetItems gPlayerShip "* +BlackMarketID;")
											'descRestaurantRespect
											'descRestaurantNoRespect
											)
									maxPerStation: 1
									})
							</Action>

							<Action id="actionLoadingDock">
								<Navigate screen="LoadingDock"/>
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>
						</Actions>
					</Default>
				</Panes>
			</Main>

			<LoadingDock>

				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen (cat "You are in the loading dock of " (objGetName gSource 4) "."))
						</OnPaneInit>

						<Actions>
							<Action id="actionSellItems" default="1">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell;)
							</Action>

							<Action id="actionLeave" cancel="1">
								<Navigate screen="Main"/>
							</Action>
						</Actions>
					</Default>
				</Panes>

			</LoadingDock>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="-90" />
			<Port x="96"	y="-70" />
			<Port x="-96"	y="-70" />
			<Port x="105"	y="-25" />
			<Port x="-105"	y="-25" />
			<Port x="68"	y="-100" />
			<Port x="-68"	y="-100" />
			<Port x="70"	y="25" />
			<Port x="-70"	y="25" />
		</DockingPorts>

        <Language>
			<Text id="actionRestaurant">"[R]estaurant"</Text>
			<Text id="actionLoadingDock">"[L]oading Dock"</Text>

			<Text id="descRestaurantRespect">
				As you enter the restaurant the maitre d' welcomes you warmly and shows
				you to a table. Envious patrons look on while you eat a wonderful dish
				of Hogei Salmon with organic yams and sweet plum sauce.
			</Text>
			<Text id="descRestaurantNoRespect">
				The maitre d' leaves you waiting for several minutes. When he finally
				turns to you he coldly tells you that there are no tables available.
				You feel out of place here.
			</Text>

			<Text id="rumor.commonwealthPub">
				You talk to a corporate woman staying at the %station%. She drones on
				about the excellent service. You spend 5 credits on drinks.
			</Text>

			<Text id="rpg.stationWillNotBuy">

				%StationName% buys food, luxuries, and meds. We are not 
				interested in buying %itemName%.

			</Text>
            <Text id="core.mapDesc">"Buys food, luxuries, and meds"</Text>
        </Language>
	</StationType>

	<!-- Level 3: Ice Farm -->

	<StationType UNID="&stIceFarm;"
			name=				"corporate ice farm"
			sovereign=			"&svCorporate;"

			attributes=			"asteroidBase, corporate, corporateCustoms, envAir, envAvoidsFire, friendly, independent, generic, human, populated"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			size=				"150"
			explosionType=		"&vtBlastExplosion1;"
			ejectaType=			"&vtIceAsteroidEjecta;"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"rccuu rv--- ----- ----- -----"

				locationCriteria=		"++outerSystem"
				/>

		<!-- Trade and Items -->

		<Trade currency="credit">
			<Sell	criteria="*NU +Lux; -defective; -NotForSale;"	priceAdj="100"/>

			<Buy	criteria="*NU +Food; -Lux; -Illegal; &lt;=$100; -NotForSale;"	priceAdj="105"/>
			<Buy	criteria="*NU" item="&itHydrocarbons;"		priceAdj="105"/>
			<Buy	criteria="*NU" item="&itHelium3FuelRod;"	priceAdj="105"/>
			<Buy	criteria="*NU" item="&itOrganicAcid;"		priceAdj="105"/>
			<Buy	criteria="*NU" item="&itMedicalSupplies;"	priceAdj="105"/>
			<Buy	criteria="*NU" item="&itHyperfiberRoll;"	priceAdj="105"/>
			<Buy	criteria="*NU" item="&itBiofactorPaste;"	priceAdj="105"/>

			<ConsumeTrade	criteria="{core.fusionFuel}"		impact="1"/>
			<ConsumeTrade	criteria="{human.res}"		impact="1"/>

			<ProduceTrade	criteria="{human.basicFood}"	impact="10"/>
		</Trade>

		<Items>
			<Item				count="4d12"	item="&itEuropanIceMoss;" />
			<Item				count="1d12"	item="&itEuropanIceVodka;" />
			<Item chance="50"	count="2d12"	item="&itHogeiSalmon;" />
		</Items>

		<!-- Configuration -->

		<Hull 	hullType=		"asteroidHull"
				armorID=		"&itPlasteelPlate;"
				hitPoints=		"120"
				regen=			"1"
				/>
		
		<!-- Ships and Defenses -->

		<Ships>
			<Ship			count="1d3+1"	class="&scTenhoveSentinel;"	orders="patrol" patrolDist="5"/>
		</Ships>

		<!-- Image and Effects -->

		<ImageVariants>
			<LocationCriteriaTable>
				<Variants criteria="*ice">
					<Image imageID="&rsIceFarmIce;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="0"/>
					<Image imageID="&rsIceFarmIce;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="220"/>
					<Image imageID="&rsIceFarmIce;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="440"/>
					<Image imageID="&rsIceFarmIce;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="660"/>
				</Variants>
				<Variants criteria="*primordial">
					<Image imageID="&rsIceFarmPrimordial;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="0"/>
					<Image imageID="&rsIceFarmPrimordial;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="220"/>
					<Image imageID="&rsIceFarmPrimordial;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="440"/>
					<Image imageID="&rsIceFarmPrimordial;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="660"/>
				</Variants>
				
				<Variants criteria="*~">
					<Image imageID="&rsIceFarmRocky;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="0"/>
					<Image imageID="&rsIceFarmRocky;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="220"/>
					<Image imageID="&rsIceFarmRocky;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="440"/>
					<Image imageID="&rsIceFarmRocky;"	imageWidth="220" imageHeight="220"	imageX="0"	imageY="660"/>
				</Variants>
			</LocationCriteriaTable>
		</ImageVariants>

		<DockingPorts
				portCount=		"8"
				portRadius=		"120"
				>
		</DockingPorts>

		<!-- Dock Screen -->

		<DockScreens>
			<Main>
				<Panes>
					<Default descID="descWelcome">
						<Actions>
							<Action id="actionBuyItems" default="1">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy;)
							</Action>

							<Action id="actionSellItems">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeSell;)
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>
						</Actions>
					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<!-- Events and Data -->

        <Language>
			<Text id="core.name">Ice Farm</Text>

			<Text id="descWelcome">

				You are docked at a corporate ice farm on a small asteroid. 
				Cold and stale air blows out of a wheezing recycler and you 
				hear the drone of struggling generators and pumps.

			</Text>
			<Text id="rpg.stationWillNotBuy">

				%StationName% buys food and supplies. We are not 
				interested in buying %itemName%.

			</Text>
            <Text id="core.mapDesc">Sells luxuries &mdash; Buys food and supplies</Text>
        </Language>

	</StationType>

	<!-- Level 8: Taikon Ventures -->

	<StationType UNID="&stTaikonVentures;"
			name=				": Taikon Ventures|Taikon Ventures"
			sovereign=			"&svCorporate;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"

			armorID=			"&itQuadroCarbideArmor;"
			hitPoints=			"470"
			multiHull=			"true"
			regen=              "5"
			fireRateAdj=		"10"

			explosionType=		"&vtThermoExplosion2;"
			ejectaType=			"&vtWreckEjecta;"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"----- -uur- ----- ----- -----"

				locationCriteria=		"+planetary"
				enemyExclusionRadius=	"75"
				/>

		<!-- Trade and Items -->

		<Trade currency="rin">
			<Sell	criteria="*NU +Taikon; -defective;"				priceAdj="100"/>
			<Sell	criteria="*NU +RingerValuable; -defective;"		priceAdj="250"/>
			<Sell	criteria="*NU +Alien; -defective;"				priceAdj="120"/>
			<Sell	criteria="*NU -defective; -ID;"					priceAdj="100"/>

			<Refuel			criteria="f +unid:&itPteracniumFuelRod;;" priceAdj="100"/>
			<Refuel			criteria="f +BasicFuel; L:1-10;" priceAdj="100"/>
			<RepairArmor	criteria="a L:1-11;" priceAdj="100"/>
			<ReplaceArmor	criteria="a L:1-11;" priceAdj="100"/>
			<InstallDevice	criteria="d L:1-11;" priceAdj="100"/>
			<RemoveDevice	criteria="d L:1-11;" priceAdj="100"/>
		</Trade>

		<Items>
			<RandomItem count="1d6" 
					criteria=		"d L:1-11; +Taikon; -NotStandard; -NotForSale"
					levelFrequency=	"systemLevel:ru|c|cur"
					/>
			<RandomItem count="1d6" 
					criteria=		"a L:1-11; +Taikon; -NotStandard; -NotForSale"
					levelFrequency=	"systemLevel:ru|c|cur"
					/>
			<RandomItem count="3d6" 
					criteria=		"m +Taikon; -illegal; -NotStandard; -NotForSale"
					levelFrequency=	"systemLevel:ru|c|cur"
					/>
			<RandomItem count="1d6" 
					criteria=		"* L:1-11; -illegal; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					/>
			<RandomItem count="2d6" 
					criteria=		"*~ad -Alien; -illegal; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:ru|c|u"
					/>
			<RandomItem count="1d3" 
					criteria=		"* L:1-11; +Alien; -illegal; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|c|cur"
					/>
			<Item	count="6d12" item="&itPteracniumFuelRod;"/>
		</Items>

		<!-- Configuration -->

		<Devices>
			<Device deviceID="&itHeavyIonBlaster;"	omnidirectional="true"/>
		</Devices>

		<!-- Ships and Defenses -->

		<Ships>
			<Ship chance="75" class="&scBritannia;" orders="guard"/>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<!-- Image and Effects -->

		<Image			imageID="&rsStations8;" imageX="0" imageY="448" imageWidth="128" imageHeight="192"/>

		<DockingPorts>
			<Port x="68"	y="35" />
			<Port x="42"	y="-71" />
			<Port x="-74"	y="-39" />
			<Port x="-38"	y="63" />
			<Port x="90"	y="-31" />
			<Port x="-28"	y="-90" />
			<Port x="-101"	y="21" />
			<Port x="36"	y="88" />
		</DockingPorts>

		<!-- Dock Screens -->

		<DockScreens>
			<Main>
				<Panes>
					<Default descID="descWelcome">
						<Actions>
							<Action id="actionBuyItems">
								(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy;)
							</Action>

							<Action id="actionDockServices" default="1">
								(rpgDockServices gPlayerShip {
									checkMilitaryID: True
									})
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>

						</Actions>
					</Default>
				</Panes>
			</Main>
		</DockScreens>

		<!-- Events and Behavior -->

		<Language>
			<Text id="descWelcome">
				You are docked at a Taikon Ventures station.
			</Text>
		</Language>
	</StationType>

	<!-- Wondrous Devices -->

	<StationType UNID="&stWondrousDevices;"
			name=				": Thor's Wondrous Devices|Thor's Wondrous Devices"
			sovereign=			"&svCorporate;"
			inherit=			"&baCorporateStation;"

			dockScreen=			"Main"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"8"

			multiHull=			"true"
			armorID=			"&itAdvancedPlasteelPlate;"
			hitPoints=			"350"
			regen=				"6"
			explosionType=		"&vtBlastExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateArms, corporateCustoms, envAir, envEarth, envFire, envWater, friendly, independent, generic, human, populated"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+corporateSpace;"
				systemAffinity=			"*"
				levelFrequency=			"---ru ur--- ----- ----- -----"

				locationCriteria=		"+planetary"
				enemyExclusionRadius=	"50"
				/>

		<Image			imageID="&rsStations5;" imageX="128" imageY="384" imageWidth="128" imageHeight="256"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Items>
			<RandomItem count="20-30" 
					criteria=		"admu L:1-9; -Illegal; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:u|c|crv"
					enhanced=		"5"
					enhancement=	"=(intCorporateGenerateEnhancement gItem)"
					/>
			<RandomItem count="8" 
					criteria=		"admu L:1-9; -Illegal; -NotStandard; -NotForSale;"
					levelFrequency=	"systemLevel:r|u|cur"
					enhanced=		"1"
					enhancement=	"=(intCorporateGenerateEnhancement gItem)"
					/>
		</Items>

		<Trade currency="credit">
			<Sell	criteria="*NU -defective; -Illegal; -ID; -NotForSale;"	priceAdj="100"/>
			<Buy	criteria="amdNU -Illegal; -ID; -NotForSale;"	priceAdj="50"/>
			<Buy	criteria="uNU -Illegal; -ID; -NotForSale;"	priceAdj="90"/>
			<Buy	criteria="amduNU -Illegal; -ID;"				priceAdj="10"/>
			
			<Refuel			criteria="f +BasicFuel; L:1-8;" priceAdj="100"/>
			<RepairArmor	criteria="a L:1-8;" priceAdj="100"/>
			<ReplaceArmor	criteria="a L:1-9;" priceAdj="100"/>
			<InstallDevice	criteria="d L:1-9;" priceAdj="100"	upgradeInstallOnly="true"/>
			<RemoveDevice	criteria="d L:1-9;" priceAdj="100"	upgradeInstallOnly="true"/>
		</Trade>

		<DockScreens>
			<Main>
				<Panes>
					<Default descID="descWelcome">
						<Actions>
							<Action id="actionDockServices" default="1">
								(rpgDockServices gPlayerShip {
									checkMilitaryID: True
									upgradeInstallOnly: True
									})
							</Action>

							<Action id="actionCommoditiesExchange">
								(scrShowScreen gScreen &dsRPGCommoditiesExchange;)
							</Action>

							<Action id="actionUndock" cancel="1">
								<Exit/>
							</Action>

						</Actions>

					</Default>
				</Panes>
			</Main>

		</DockScreens>

		<DockingPorts>
			<Port x="90"	y="15" />
			<Port x="-90"	y="15" />
			<Port x="90"	y="90" />
			<Port x="-90"	y="90" />
			<Port x="60"	y="-30" />
			<Port x="-60"	y="-30" />

			<Port x="0"		y="-50" />
			<Port x="0"		y="130" />
		</DockingPorts>

		<Language>
			<Text id="descWelcome">
				You are docked at a franchise of Thor's Wondrous Devices.
			</Text>
		</Language>
	</StationType>

<!-- SHIP CLASSES -->

	<!-- Level 8: Corporate Explorer -->

	<ShipClass UNID="&scCorporateExplorer;"
			manufacturer=		"Rasiermesser"
			class=				"Svalbard"
			type=				"explorer"
			defaultSovereign=	"&svCorporate;"

			attributes=			"capitalShip, corporate, genericClass, majorShip"
			inherit=			"&baHumanTechShip;"
			>

		<!-- Hull -->

		<Hull
			size=				"195"
			mass=				"4000"
			cargoSpace=			"1000"

			cyberDefenseLevel=	"8"
			/>

		<Drive
			maxSpeed=			"10"
			thrust=				"5000"
			/>

		<Maneuver
			maxRotationRate=	"3"
			rotationAccel=		"0.5"
			/>

		<Interior>
			<Compartment name="interior"
					hitPoints=	"120"
					/>

			<Compartment name="main drive"
					type=		"mainDrive"
					hitPoints=	"80"

					posX=		"-61"
					posY=		"0"
					sizeX=		"60"
					sizeY=		"40"
					/>
		</Interior>

		<Wreck
			explosionType=		"&vtThermoExplosion2;"
			/>

		<!-- Configuration -->

		<Armor
			armorID=			"&itQuadroCarbideArmor;"
			count=				"16"
			/>

		<Devices>
			<Device deviceID="&itPlasmaShieldGenerator;"/>
		</Devices>

		<Items>
			<Item count="2d12" item="&itPteracniumFuelRod;"/>
		</Items>

		<!-- Image and Effects -->

		<Image imageID="&rsCorporateExplorerHD;" imageWidth="192" imageHeight="192"	rotationCount="120" rotationColumns="12" viewportRatio="0.025"/>
		<HeroImage imageID="&rsCorporateExplorerHero;" imageWidth="320" imageHeight="320"/>

		<Effects>
			<Effect type="thrustMain"		posAngle="176"	posRadius="88"	posZ="0"	rotation="180"	effect="&efMainThrusterLarge;"/>
			<Effect type="thrustMain"		posAngle="-176"	posRadius="88"	posZ="0"	rotation="180"	effect="&efMainThrusterLarge;"/>
		</Effects>

		<!-- AI and Behavior -->

		<AISettings
			fireRateAdj=		"25"
			fireAccuracy=		"95"
			perception=			"4"
			/>
	</ShipClass>

	<!-- Level 9: Corporate Cruiser -->

	<ShipClass UNID="&scCorporateCruiser;"
			manufacturer=		"Rasiermesser"
			class=				"Eir"
			type=				"cruiser"
			defaultSovereign=	"&svCorporate;"

			attributes=			"capitalShip, corporate, genericClass, majorShip"
			inherit=			"&baHumanTechShip;"
			>

		<!-- Hull -->

		<Hull
			size=				"275"
			mass=				"25000"
			cargoSpace=			"1000"

			cyberDefenseLevel=	"8"
			/>

		<Drive
			maxSpeed=			"20"
			thrust=				"50000"
			/>

		<Maneuver
			maxRotationRate=	"3.0"
			rotationAccel=		"0.5"
			/>

		<DeviceSlots>
			<DeviceSlot id="portArm1"		criteria="w"	posAngle="114"   posRadius="60"   posZ="0"	fireAngle="90"	fireArc="220"	secondaryWeapon="true"/>
			<DeviceSlot id="starboardArm1"	criteria="w"	posAngle="-114"  posRadius="60"   posZ="0"	fireAngle="-90"	fireArc="220"	secondaryWeapon="true"/>
		</DeviceSlots>

		<Interior>
			<Compartment name="interior"
					hitPoints=	"300"
					/>
			
			<Compartment name="main drive"
					type=		"mainDrive"
					hitPoints=	"100"

					posX=		"-25"
					posY=		"0"
					sizeX=		"50"
					sizeY=		"40"
					/>
		</Interior>

		<Wreck
			explosionType=		"&vtThermoExplosion3;"
			/>

		<!-- Configuration -->
		
		<Armor
			armorID=			"&itHexaCarbideArmor;"
			count=				"16"
			/>
		
		<Devices>
			<Device slotID="portArm1"		deviceID="&itRasiermesserLauncher;">
				<Items>
					<Item count="40d20" item="&itGotha10Missile;"/>
				</Items>
			</Device>
			<Device slotID="starboardArm1"	deviceID="&itRasiermesserLauncher;"/>
			<Device deviceID="&itPlasmaShieldGenerator;"/>
		</Devices>

		<Items>
			<Item count="2d12" item="&itPteracniumFuelRod;"/>
		</Items>

		<!-- Image and Effects -->

		<Image imageID="&rsCorporateCruiserHD;" imageWidth="230" imageHeight="230"	rotationCount="120" rotationColumns="12" viewportRatio="0.035"/>
		<HeroImage imageID="&rsCorporateCruiserHero;" imageWidth="320" imageHeight="320"/>

		<Effects>
			<Effect type="thrustMain"		posAngle="180"	posRadius="0"	posZ="-10"	rotation="180"	sendToBack="*"/>
		</Effects>
		
		<!-- AI and Behavior -->
		
		<AISettings
			fireRateAdj=		"40"
			fireAccuracy=		"95"
			perception=			"4"

			ignoreShieldsDown=	"true"
			/>

		<Events>
			<OnDestroy>
				(switch
					;	We don't care if an object ascends or enters a stargate
					
					(or (= aDestroyReason 'ascended) (= aDestroyReason 'enteredStargate))
						Nil

					;	Handle it

					(block ()

						;	Destroy items on the wreck, because we don't want too much loot

						(if aWreckObj
							(rpgDestroyItems aWreckObj)
							)
						)
					)
			</OnDestroy>
		</Events>
	</ShipClass>

<!-- GLOBALS -->

	<Globals>
		(block Nil
			(setq intBushidoArmorEnhancement (lambda Nil
				(random (list
					{	enhancement:"+hpBonus:10"			type:&itPlasteelNanos;	}
					{	enhancement:"+hpBonus:20"			type:&itPlasteelNanos;	}
					{	enhancement:"+hpBonus:20"			type:&itPlasteelNanos;	}
					{	enhancement:"+hpBonus:30"			type:&itPlasteelNanos;	}
					{	enhancement:"+hpBonus:40"			type:&itPlasteelNanos;	}
					{	enhancement:"+reflect:laser"		type:&itReflectiveArmorCoating;	}
					{	enhancement:"+reflect:particle"		type:&itParticleReflectCoating; }
					))
				))

			(setq intBushidoShieldEnhancement (lambda Nil
				(random (list
					{	enhancement:"+hpBonus:10"			type:&itDiamondCrystal;	}
					{	enhancement:"+hpBonus:20"			type:&itDiamondCrystal;	}
					{	enhancement:"+hpBonus:20"			type:&itDiamondCrystal;	}
					{	enhancement:"+hpBonus:30"			type:&itDiamondCrystal;	}
					{	enhancement:"+hpBonus:40"			type:&itDiamondCrystal;	}
					{	enhancement:"+resistDamageTier:particle:60"		type:&itRubidiumCrystal;	}
					{	enhancement:"+resistDamageTier:ion:60"		type:&itSuperlatticeCrystal; }
					{	enhancement:"+efficient:20"			type:&itShieldPowerSaver;	}
					))
				))

			(setq intBushidoWeaponEnhancement (lambda (theItem)
				(random (list
					{	enhancement:"+hpBonus:10"			type:(intGetEnhancementByDamageType theItem)	}
					{	enhancement:"+hpBonus:20"			type:(intGetEnhancementByDamageType theItem)	}
					{	enhancement:"+hpBonus:20"			type:(intGetEnhancementByDamageType theItem)	}
					{	enhancement:"+hpBonus:30"			type:(intGetEnhancementByDamageType theItem)	}
					{	enhancement:"+efficient:20"			type:&itWeaponEfficiencyROM;	}
					{	enhancement:"+speed:80"				type:&itWeaponSpeedROM;	}
					))
				))

			(setq intCorporateCrime (lambda (severity description)
				(block (
					(curSeverity (int (objGetData gPlayerShip 'corpCrimeSeverity)))
					)
					(switch
						;	If this crime is more severe than the current crime on record,
						;	then we replace it.

						(gr severity curSeverity)
							(block Nil
								(objSetData gPlayerShip 'corpCrimeSeverity severity)
								(objSetData gPlayerShip 'corpCrime description)
								)

						;	If we just committed a level 3 crime and we've already committed
						;	one previously, then this becomes a level 4 crime.

						(= severity curSeverity 3)
							(block Nil
								(objSetData gPlayerShip 'corpCrimeSeverity 4)
								(objSetData gPlayerShip 'corpCrime (typTranslate &svCorporate; 'crimeMassDestruction))
								)
						)
					)
				))

			(setq intCorporateGenerateEnhancement (lambda (theItem)
				(intCreateHPBonusEnhancement theItem
					(random (list 
						"+hpBonus:10"
						"+hpBonus:20"
						"+hpBonus:20"
						"+hpBonus:30"
						))
					)
				))

			(setq intCorporateOnDestroy (lambda Nil
				(block (corporateCruiser theDestroyer)
					; Destroy items on the station
					(rpgDestroyItems gSource)

					; Create a corporate cruiser to avenge the station
					(setq corporateCruiser
						(sysCreateShip &scCorporateCruiser; (objGetNearestStargate gSource) &svCorporate;)
						)

					; If someone destroyed the station, avenge
					(setq theDestroyer aOrderGiver)
					(if (and theDestroyer
							(objCanAttack theDestroyer)
							(not (eq (objGetSovereign theDestroyer) &svCorporate;)))
						(block Nil
							(objSendMessage gPlayerShip gSource "Security alert! Deploy corporate enforcer!")
							(shpOrderAttack corporateCruiser theDestroyer)

							; Since the cruiser is busy, deploy some transports to loot the station
							(for i 1 (random 1 3)
								(block (transport)
									(setq transport
										(sysCreateShip &scEI500; (objGetNearestStargate gSource) &svCorporate;)
										)

									(shpOrderLoot transport gSource)
									(shpOrderGate transport)
									)
								)
							)
						)

					; If the player destroyed the station, then she is banned
					(if (and gPlayerShip (eq aOrderGiver gPlayerShip))
						(intCorporateCrime 3 (cat "the destruction of " (objGetName gSource 4)))
						)

					; Take all the items from the station (so that others won't loot it)
					(shpOrderLoot corporateCruiser gSource)

					; Gate out
					(shpOrderGate corporateCruiser)
					)
				))

			(setq intHPEnhancement1 (lambda (theItem)
				(intCreateHPBonusEnhancement theItem
					(random (list 
						"+hpBonus:10"
						"+hpBonus:10"
						"+hpBonus:20"
						"+hpBonus:20"
						"+hpBonus:30"
						))
					)
				))

			(setq intHPEnhancement2 (lambda (theItem)
				(intCreateHPBonusEnhancement theItem
					(random (list 
						"+hpBonus:10"
						"+hpBonus:20"
						"+hpBonus:20"
						"+hpBonus:30"
						"+hpBonus:30"
						"+hpBonus:40"
						))
					)
				))

			(setq intHPEnhancement3 (lambda (theItem)
				(intCreateHPBonusEnhancement theItem
					(random (list 
						"+hpBonus:20"
						"+hpBonus:30"
						"+hpBonus:30"
						"+hpBonus:40"
						"+hpBonus:40"
						"+hpBonus:50"
						))
					)
				))

			(setq intMakayevArmorEnhancement (lambda (theItem)
				(random (append 
					(list
						{	enhancement:"+hpBonus:10"			type:&itPlasteelNanos;	}
						{	enhancement:"+hpBonus:20"			type:&itPlasteelNanos;	}
						{	enhancement:"+hpBonus:20"			type:&itPlasteelNanos;	}
						{	enhancement:"+hpBonus:30"			type:&itPlasteelNanos;	}
						{	enhancement:"+hpBonus:30"			type:&itPlasteelNanos;	}
						{	enhancement:"+hpBonus:40"			type:&itPlasteelNanos;	}
						)
					(if (not (itm@ theItem 'radiationImmune))
						(list
							{	enhancement:"+immunity:radiation"	type:&itRadiationImmuneCoating;	}
							)
						)
					(if (not (itm@ theItem 'empImmune))
						(list
							{	enhancement:"+immunity:ionEffects"	type:&itIonEffectImmuneCoating; }
							)
						)
					))
				))

			(setq intMakayevWeaponEnhancement (lambda (theItem)
				(intCreateHPBonusEnhancement theItem
					(random (list 
						"+hpBonus:20"
						"+hpBonus:30"
						"+hpBonus:30"
						"+hpBonus:40"
						"+hpBonus:40"
						"+hpBonus:50"
						))
					)
				))

			(setq intGetEnhancementByDamageType (lambda (theItem)
				(block (
					(damageType (itmGetProperty theItem 'damageTypeID))
					)
					(switch
						(= damageType 'laser)		&itLaserAmplifier;
						(= damageType 'kinetic)		&itKineticUpgrade;
						(= damageType 'particle)	&itParticleUpgrade;
						(= damageType 'blast)		&itBlastUpgrade;
						(= damageType 'ion)			&itIonUpgrade;
						(= damageType 'thermo)		&itThermoUpgrade;
						)
					)
				))

			(setq intCreateHPBonusEnhancement (lambda (theItem theMod)
				(block (
					(theCategory (itmGetProperty theItem 'category))
					)
					(switch
						(= theCategory 'armor)
							{	enhancement:theMod		type:&itPlasteelNanos;	}

						(= theCategory 'shields)
							(switch
								(leq (itmGetLevel theItem) 5)
									{	enhancement:theMod		type:&itSilicarbCrystal;	}

								{	enhancement:theMod		type:&itDiamondCrystal;	}
								)

						(= theCategory 'weapon)
							{	enhancement:theMod		type:(intGetEnhancementByDamageType theItem) }

						;	No enhancement. Note that sometimes this gets called
						;	on a non-enhanceable item (e.g., ammo).
						)
					)
				))
			)
	</Globals>

<!-- DOCK SCREENS -->

	<!-- Arms Dealer Screen -->

	<DockScreen UNID="&dsArmsDealerSpecial;"
			inherit="&dsDockScreenBase;"
			>
		<Panes>
			<Default>
				<OnPaneInit>
					(scrSetDesc gScreen (cat "You are docked at " (objGetStaticData gSource "LongName") "."))
				</OnPaneInit>

				<Actions>
					<Action id="actionDockServices" default="1">
						(rpgDockServices gPlayerShip {
							checkMilitaryID: True
							})
					</Action>

					<Action id="actionBuyItems">
						(scrShowScreen gScreen &dsRPGCommoditiesExchangeBuy;)
					</Action>

					<Action id="actionUndock" cancel="1">
						<Exit/>
					</Action>
				</Actions>

			</Default>
		</Panes>
	</DockScreen>

	<!-- Corporate Imprison -->

	<DockScreen UNID="&dsCorporateImprison;"	
			inherit="&dsDockScreenBase;"
			nestedScreen="true"
			>
		<Panes>
			<Default>
				<OnPaneInit>
					(scrSetDesc gScreen (cat "As you enter the station you are surrounded by heavily armed soldiers. A corporate officer approaches you: \"You are under arrest for " (objGetData gPlayerShip "corpCrime") "\"" ))
				</OnPaneInit>

				<Actions>
					<Action id="actionContinue" default="1" cancel="1">
						(block Nil
							(plyDestroyed gPlayer (cat "was imprisoned for " (objGetData gPlayerShip "corpCrime")))
							(scrExitScreen gScreen 'forceUndock)
							)
					</Action>
				</Actions>
			</Default>
		</Panes>
	</DockScreen>
	
<!-- BASE CLASSES -->
	
	<!-- Corporate Hierarchy Station Base Class
	
	USAGE: Corporate stations should inherit from this class. Derived classes
		should manually call OnCreate and OnDestroy in case they need to override
		those events.
	
	-->
	
	<Type unid="&baCorporateStation;"
		inherit=			"&unidCommonText;"
		>
		<Properties>
			<!--
			By default we accept any military ID (even ones from APD or ED).
			-->
			<Constant	id="rpg.checkMilitaryID">"* +militaryID;"</COnstant>

			<!--
			By default we reveal unknown items when they are for sale.
			-->
			<Constant	id="rpg.showActualItem">True</COnstant>
		</Properties>

		<Events>
			<OnDestroy>
				(intCorporateOnDestroy)
			</OnDestroy>
		</Events>
		
		<Language>
			<Text id="actionOperations">[O]perations Level</Text>

			<Text id="customs.chargedForDecon">

				Corporate security stops your ship for decontamination.
				You are automatically charged %cost% for decontaminating your ship.

			</Text>
			<Text id="customs.cantAffordDecon">

				Corporate security stops your ship for decontamination.
				Unfortunately, you do not have %cost% to pay for decontamination.

			</Text>
		</Language>
	</Type>

<!-- TABLES -->

	<ShipTable unid="&tbCorpDefenders;">
		<LevelTable>
			<Ship levelFrequency="cccr- -----" count="1" class="&scRoninA;" orders="guard"/>
			<Ship levelFrequency="ruucc cr---" count="1" class="&scRoninB;" orders="guard"/>
			<Ship levelFrequency="uuucc cur--" count="1" class="&scWolfen;" orders="guard"/>
			<Ship levelFrequency="---uu ccccu" count="1" class="&scRoninC;" orders="guard"/>
			<Ship levelFrequency="ccccc ccccc" count="1" class="&scCenturionBlock2;" orders="guard"/>
			<Ship levelFrequency="--ruc cuuuu" count="1" class="&scManticore;" orders="guard"/>
			<Ship levelFrequency="----- -uuuu" count="1" class="&scBritannia;" orders="guard"/>
		</LevelTable>
	</ShipTable>
	
<!-- RESOURCES -->

	<Image UNID="&rsCorporateArmorDealer;"	bitmap="Resources\CorporateArmorDealer.jpg" bitmask="Resources\CorporateArmorDealerMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsCorporateArmsDealer;"	bitmap="Resources\CorporateArmsDealer.jpg" bitmask="Resources\CorporateArmsDealerMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsCorporateEnclave;"		bitmap="Resources\CorporateEnclave.jpg" bitmask="Resources\CorporateEnclaveMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsCorporateFuelDepot;"	bitmap="Resources\CorporateFuelDepot.jpg" bitmask="Resources\CorporateFuelDepotMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsCorporateManufacturing;"	bitmap="Resources\CorporateManufacturing.jpg" bitmask="Resources\CorporateManufacturingMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsIceFarmIce;"			bitmap="Resources\IceFarmIce.jpg" bitmask="Resources\IceFarmIceMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsIceFarmPrimordial;"		bitmap="Resources\IceFarmPrimordial.jpg" bitmask="Resources\IceFarmPrimordialMask.bmp" loadOnUse="true"/>
	<Image UNID="&rsIceFarmRocky;"			bitmap="Resources\IceFarmRocky.jpg" bitmask="Resources\IceFarmRockyMask.bmp" loadOnUse="true"/>

	<Image UNID="&rsCorporateCruiserHD;"	bitmap="Resources\CorporateCruiserHD.jpg" bitmask="Resources\CorporateCruiserHDMask.bmp"  loadOnUse="true"/>
	<Image UNID="&rsCorporateCruiserHero;"	bitmap="Resources\CorporateCruiserLarge.jpg" bitmask="Resources\CorporateCruiserLargeMask.bmp"  loadOnUse="true"/>
	
	<Image UNID="&rsCorporateExplorerHD;"	bitmap="Resources\CorporateExplorerHD.jpg" bitmask="Resources\CorporateExplorerHDMask.bmp"  loadOnUse="true"/>
	<Image UNID="&rsCorporateExplorerHero;"	bitmap="Resources\CorporateExplorerLarge.jpg" bitmask="Resources\CorporateExplorerLargeMask.bmp"  loadOnUse="true"/>

	<!-- Deprecate when we re-do Huygens Explorer -->

</TranscendenceModule>
