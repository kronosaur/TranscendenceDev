<?xml version="1.0" encoding="utf-8"?>

<TranscendenceModule>

	<Sovereign UNID="&svSung;"
			name=":the Sung civilization"
			shortName=":the Sung"
			adjective="Sung"
			demonym=":a Sung Slaver(s)"
			plural="true"

			alignment="destructive order"
			/>

	<Sovereign UNID="&svSungSlaves;"
			name="slaves of Sung"
			demonym=":a slave(s) of Sung"

			alignment="neutral"
			/>

	<SystemMap unid="&smSungSpace;"
			displayOn="&smHumanSpace;"
			>
		<TopologyProcessor priority="primaryColony">

			<System criteria="+ungoverned;"	attributes="sungSpace"/>

			<!-- In addition, any system within 4 gates of Jiang's Star is 
				considered Sung territory. -->

			<System attributes="sungSpace">
				<Criteria>
					<DistanceTo nodeID="C9" min="0" max="4"/>
				</Criteria>
			</System>

			<!-- Any system within 1 gate of Jiang's Star is considered 
				CORE Sung territory. -->

			<System attributes="sungCore">
				<Criteria>
					<DistanceTo nodeID="C9" min="0" max="1"/>
				</Criteria>
			</System>
		</TopologyProcessor>
	</SystemMap>

<!-- ENCOUNTERS -->

	<!-- Sung Fortress -->

	<StationType UNID="&stSungFortress;"
			name=				"Sung fortress(es)"
			sovereign=			"&svSung;"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itSungArmor;"
			hitPoints=			"400"
            regen=              "11"
			explosionType=		"&vtBlastExplosion4;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"enemy, envAir, envEarth, envFire, envWater, generic, human, majorStation, populated, sungSlavers"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+sungSpace;"
				systemAffinity=			"*"
				levelFrequency=			"---vc uu--- ----- ----- -----"

				locationCriteria=		"+planetary"
				enemyExclusionRadius=	"100"
				/>

		<Image			imageID="&rsStations4;" imageX="0" imageY="192" imageWidth="128" imageHeight="128"/>

		<Ships>
			<Table>
				<Ship chance="30"	count="2d6" class="&scWindSlaver;"		orders="patrol" patrolDist="20"/>
				<Group chance="60">
					<Ship			count="1"	class="&scSteelSlaver;"		orders="patrol" patrolDist="20"/>
					<Ship			count="2d4"	class="&scWindSlaver;"		orders="patrol" patrolDist="20"/>
				</Group>
				<Ship chance="10"	count="1d4"	class="&scSteelSlaver;"		orders="patrol" patrolDist="20"/>
			</Table>
		</Ships>

		<Reinforcements minShips="3">
			<Table>
				<Ship chance="75"	count="1d4"	class="&scWindSlaver;"	orders="patrol" patrolDist="20"/>
				<Ship chance="25"	count="1d2"	class="&scSteelSlaver;"	orders="patrol" patrolDist="20"/>
			</Table>
		</Reinforcements>

		<Items>
			<Lookup					count="1d4"	table="&trStationSupplies;" />
			<Lookup					count="1"	table="&trConsumables6;"/>
			<Lookup					count="1"	table="&trMinorItem6;"/>
			<Table chance="75">
				<Lookup chance="40" count="1" table="&trConsumables7;"/>
				<Lookup chance="40" count="1" table="&trMinorItem7;"/>
				<Lookup chance="20" count="1" table="&trMajorItem7;"/>
			</Table>
		</Items>

		<Encounters frequency="common">
			<Ship   count="1d4"	class="&scWindSlaver;" orders="attack"/>
		</Encounters>

		<Satellites>
			<Station type="&stSungNEWall;" xOffset="64" yOffset="64"	segment="true"/>
			<Station type="&stSungNWWall;" xOffset="-64" yOffset="64"	segment="true"/>
			<Station type="&stSungSWWall;" xOffset="-64" yOffset="-64"	segment="true"/>
			<Station type="&stSungSEWall;" xOffset="64" yOffset="-64"	segment="true"/>
		</Satellites>

	</StationType>

	<!-- Sung Citadel -->

	<StationType UNID="&stSungCitadel;"
			name=				"Sung citadel"
			sovereign=			"&svSung;"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itSungArmor;"
			hitPoints=			"1500"
            regen=              "11"
			fireRateAdj=		"20"
			explosionType=		"&vtThermoExplosion3;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"enemy, envAir, envEarth, envFire, envWater, generic, human, majorStation, populated, sungSlavers"
			>

		<!-- Encounter Info -->

		<Encounter
				systemCriteria=			"+sungSpace;"
				systemAffinity=			"*"
				levelFrequency=			"----r ur--- ----- ----- -----"

				locationCriteria=		"+planetary"
				enemyExclusionRadius=	"100"
				/>

		<Image			imageID="&rsStations6;" imageX="0" imageY="0" imageWidth="256" imageHeight="256"/>

		<Devices>
			<Device deviceID="&itCyberDeckLowerShields;"/>
			<Device deviceID="&itParticleBeamWeapon;"	omnidirectional="true" posAngle="40"  posRadius="120"/>
			<Device deviceID="&itParticleBeamWeapon;"	omnidirectional="true" posAngle="145" posRadius="125"/>
			<Device deviceID="&itParticleBeamWeapon;"	omnidirectional="true" posAngle="270" posRadius="90"/>
		</Devices>

		<Ships>
			<Table>
				<Group chance="60">
					<Ship			count="1"	class="&scEarthSlaver;"		orders="patrol" patrolDist="30"/>
					<Ship			count="1d2"	class="&scSteelSlaver;"		orders="patrol" patrolDist="20"/>
					<Ship			count="1d3"	class="&scWindSlaver;"		orders="patrol" patrolDist="20"/>
				</Group>
				<Group chance="30">
					<Ship			count="1"	class="&scEarthSlaver;"		orders="patrol" patrolDist="30"/>
					<Ship			count="1d6"	class="&scWindSlaver;"		orders="patrol" patrolDist="20"/>
				</Group>
				<Group chance="10">
					<Ship			count="1d4"	class="&scSteelSlaver;"		orders="patrol" patrolDist="20"/>
					<Ship			count="1d6"	class="&scWindSlaver;"		orders="patrol" patrolDist="20"/>
				</Group>
			</Table>
		</Ships>

		<Reinforcements minShips="5">
			<Table>
				<Ship chance="50"	count="1d3"	class="&scWindSlaver;"	orders="patrol" patrolDist="20"/>
				<Ship chance="30"	count="1d2"	class="&scSteelSlaver;"	orders="patrol" patrolDist="20"/>
				<Ship chance="20"	count="1"	class="&scEarthSlaver;"	orders="patrol" patrolDist="30"/>
			</Table>
		</Reinforcements>

		<Items>
			<Item chance="80"		count="1d4" item="&itLongzhuSphere;"/>
			<Lookup					count="1d4"	table="&trStationSupplies;" />
			<Lookup					count="1"	table="&trConsumables6;"/>
			<Lookup					count="1"	table="&trMinorItem6;"/>
			<Table>
				<Lookup chance="45" count="1" table="&trConsumables7;"/>
				<Lookup chance="30" count="1" table="&trMinorItem7;"/>
				<Lookup chance="25" count="1" table="&trMajorItem7;"/>
			</Table>
		</Items>

		<Encounters frequency="common">
			<Table>
				<Ship chance="30"	count="2d3" class="&scWindSlaver;"		orders="attack"/>
				<Group chance="60">
					<Ship			count="1"	class="&scSteelSlaver;"		orders="attack"/>
					<Ship			count="1d4"	class="&scWindSlaver;"		orders="attack"/>
				</Group>
				<Ship chance="10"	count="1d4"	class="&scSteelSlaver;"		orders="attack"/>
			</Table>
		</Encounters>

		<Satellites overlapCheck="asteroids">
			<Orbitals count="8" distance="14" angle="equidistant">
				<Station type="&stSungDefenseSat1;"/>
			</Orbitals>
		</Satellites>

	</StationType>

	<!-- Sung Defense Satellite -->

	<StationType UNID="&stSungDefenseSat1;"
			name=				"Sung defense satellite"
			sovereign=			"&svSung;"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			noMapLabel=			"true"
			fireRateAdj=		"40"
			noFriendlyFire=		"true"
			canAttack=			"true"

			mass=				"2500"
			armorID=			"&itPlasteelPlate;"
			hitPoints=			"60"
			structuralHitPoints="20"
			ejectaType=			"&vtWreckEjecta;"
			>

		<Image			imageID="&rsStations4;" imageX="192" imageY="0" imageWidth="32" imageHeight="32"/>

		<Devices>
			<Device deviceID="&itParticleBeamWeapon;"	omnidirectional="true"/>
		</Devices>

		<DockingPorts
				portCount=		"2"
				portRadius=		"24"
				maxDist=		"3"
				/>
	</StationType>

	<!-- Sung Walls -->

	<StationType UNID="&stSungNWWall;"
			name=				"Sung defense tower"
			sovereign=			"&svSung;"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"4"
			noMapLabel=			"true"
			noFriendlyFire=		"true"
			canAttack=			"true"

			mass=				"50000"
			multiHull=			"true"
			armorID=			"&itSungArmor;"
			hitPoints=			"120"
			structuralHitPoints="100"
			fireRateAdj=		"30"
			ejectaType=			"&vtWreckEjecta;"
			>

		<Image			imageID="&rsStations5;" imageX="0" imageY="0" imageWidth="128" imageHeight="128"/>

		<Devices>
			<Device deviceID="&itParticleBeamWeapon;"	omnidirectional="true"/>
		</Devices>

	</StationType>

	<StationType UNID="&stSungNEWall;"
			name=				"Sung defense tower"
			sovereign=			"&svSung;"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"4"
			noMapLabel=			"true"
			noFriendlyFire=		"true"
			canAttack=			"true"

			mass=				"50000"
			multiHull=			"true"
			armorID=			"&itSungArmor;"
			hitPoints=			"120"
			structuralHitPoints="100"
			fireRateAdj=		"30"
			ejectaType=			"&vtWreckEjecta;"
			>

		<Image			imageID="&rsStations5;" imageX="128" imageY="0" imageWidth="128" imageHeight="128"/>

		<Devices>
			<Device deviceID="&itParticleBeamWeapon;"	omnidirectional="true"/>
		</Devices>

	</StationType>

	<StationType UNID="&stSungSEWall;"
			name=				"Sung defense tower"
			sovereign=			"&svSung;"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"4"
			noMapLabel=			"true"
			noFriendlyFire=		"true"
			canAttack=			"true"

			mass=				"50000"
			multiHull=			"true"
			armorID=			"&itSungArmor;"
			hitPoints=			"120"
			structuralHitPoints="100"
			fireRateAdj=		"30"
			ejectaType=			"&vtWreckEjecta;"
			>

		<Image			imageID="&rsStations5;" imageX="128" imageY="128" imageWidth="128" imageHeight="128"/>

		<Devices>
			<Device deviceID="&itParticleBeamWeapon;"	omnidirectional="true"/>
		</Devices>

	</StationType>

	<StationType UNID="&stSungSWWall;"
			name=				"Sung defense tower"
			sovereign=			"&svSung;"
			abandonedScreen=	"&dsRPGAbandonedStation;"
			dockingPorts=		"4"
			noMapLabel=			"true"
			noFriendlyFire=		"true"
			canAttack=			"true"

			mass=				"50000"
			multiHull=			"true"
			armorID=			"&itSungArmor;"
			hitPoints=			"120"
			structuralHitPoints="100"
			fireRateAdj=		"30"
			ejectaType=			"&vtWreckEjecta;"
			>

		<Image			imageID="&rsStations5;" imageX="0" imageY="128" imageWidth="128" imageHeight="128"/>

		<Devices>
			<Device deviceID="&itParticleBeamWeapon;"	omnidirectional="true"/>
		</Devices>

	</StationType>

<!-- SHIP CLASSES -->

	<!-- Slaver, Wind -->

	<ShipClass UNID="&scWindSlaver;"
			manufacturer=		"Sung Empire"
			class=				"Wind slaver"
			type=				""
			defaultSovereign=	"&svSung;"

			attributes=			"genericClass, sungSlavers"
			   
			mass=				"20"
			thrustRatio=		"14"
			maxSpeed=			"30"
			cargoSpace=			"10"

			cyberDefenseLevel=	"4"
			>

		<!-- Configuration -->
		
		<Armor
			armorID=			"&itLightSungArmor;"
			count=				"1"
			/>
		
		<Devices>
			<Device deviceID="&itNeutronBlaster;"/>
		</Devices>

		<Maneuver
			maxRotationRate=	"18.0"
			rotationAccel=		"4.0"
			/>

		<!-- Image and Effects -->
		
		<Image imageID="&rsWindSlaverHD;" imageX="0" imageY="0" imageWidth="48" imageHeight="48" rotationCount="120" rotationColumns="12" />

		<Effects>
			<Effect type="thrustMain"		posAngle="141"	posRadius="7"	posZ="0"	rotation="180"/>
			<Effect type="thrustMain"		posAngle="-141"	posRadius="7"	posZ="0"	rotation="180"/>
		</Effects>

		<!-- AI and Behavior -->
		
		<AISettings
			fireRateAdj=		"20"
			fireRangeAdj=		"50"
			fireAccuracy=		"90"
			perception=			"4"
			/>

	</ShipClass>

	<!-- Slaver, Steel -->

	<ShipClass UNID="&scSteelSlaver;"
			manufacturer=		"Sung Empire"
			class=				"Steel slaver"
			type=				""
			defaultSovereign=	"&svSung;"

			attributes=			"genericClass, sungSlavers"
			   
			mass=				"150"
			thrustRatio=		"4"
			maxSpeed=			"15"
			cargoSpace=			"10"

			cyberDefenseLevel=	"6"
			>

		<!-- Configuration -->
		
		<Armor
			armorID=			"&itSungArmor;"
			count=				"4"
			/>
		
		<Devices>
			<Device deviceID="&itParticleBeamWeapon;" omnidirectional="true"/>
			<Device deviceID="&itCyberDeckDisarm;"/>
			<Device deviceID="&itYoroiS100;"/>
		</Devices>

		<Maneuver
			maxRotationRate=	"5.0"
			rotationAccel=		"1.0"
			/>

		<Items>
			<Item chance="50"	count="1d6"		item="&itHeliumAssembly;"/>
		</Items>

		<!-- Image and Effects -->
		
		<Image imageID="&rsSteelSlaverHD;" imageX="0" imageY="0" imageWidth="64" imageHeight="64" rotationCount="120" rotationColumns="12" />

		<Effects>
			<Effect type="thrustMain"		posAngle="166"	posRadius="25"	posZ="0"	rotation="180"/>
			<Effect type="thrustMain"		posAngle="-166"	posRadius="25"	posZ="0"	rotation="180"/>
		</Effects>

		<!-- AI and Behavior -->

		<AISettings
			fireRateAdj=		"40"
			fireRangeAdj=		"50"
			fireAccuracy=		"90"
			perception=			"4"
			
			combatStyle=		"advanced"
			/>

	</ShipClass>

	<!-- Level 6: Slaver, Earth -->

	<ShipClass UNID="&scEarthSlaver;"
			manufacturer=		"Sung Empire"
			class=				"Earth Slaver"
			type=				""
			defaultSovereign=	"&svSung;"

			attributes=			"capitalShip, genericClass, sungSlavers"
			   
			size=				"110"
			mass=				"11000"
			thrustRatio=		"1"
			maxSpeed=			"12"
			cargoSpace=			"500"

			cyberDefenseLevel=	"6"

			explosionType=		"&vtBlastExplosion2;"
			>

		<!-- Configuration -->
		
		<Armor
			armorID=			"&itHeavySungArmor;"
			count=				"12"
			/>
		
		<Devices>
			<Device deviceID="&itParticleBoltCannon;">
				<Items>
					<Item  count="20d20"	item="&itParticleBoltCartridge;"/>
				</Items>
			</Device>
			<Device deviceID="&itCyberDeckLowerShields;"/>
			<Device deviceID="&itParticleBeamWeapon;" secondaryWeapon="true" minFireArc="350" maxFireArc="190" posAngle="102" posRadius="54" posZ="0"/>
			<Device deviceID="&itParticleBeamWeapon;" secondaryWeapon="true" minFireArc="170" maxFireArc="10" posAngle="-102" posRadius="54" posZ="0"/>
			<Device deviceID="&itYoroiS100;"/>
		</Devices>

		<Maneuver
			maxRotationRate=	"5"
			rotationAccel=		"0.5"
			/>

		<Interior>
			<Compartment name="interior"
					hitPoints=	"100"
					/>
			
			<Compartment name="main drive"
					type=		"mainDrive"
					hitPoints=	"100"

					posX=		"-43"
					posY=		"0"
					sizeX=		"42"
					sizeY=		"68"
					/>
		</Interior>

		<Items>
			<Item				  count="4d6"	item="&itXenotiteFuelRod;"/>
			<Table>
				<Lookup chance="40" count="1" table="&trConsumables6;"/>
				<Lookup chance="40" count="1" table="&trMinorItem6;"/>
				<Lookup chance="20" count="1" table="&trMajorItem6;"/>
			</Table>
		</Items>

		<!-- Image and Effects -->

		<Image imageID="&rsMediumShips4;" imageX="384" imageY="0" imageWidth="128" imageHeight="128"/>

		<Effects>
			<Effect type="thrustMain"		posAngle="180"	posRadius="48"	posZ="-7"	rotation="180"	effect="&efMainThrusterLarge;"	sendToBack="*"/>
			<Effect type="thrustMain"		posAngle="159"	posRadius="52"	posZ="0"	rotation="180"	effect="&efMainThrusterLarge;"/>
			<Effect type="thrustMain"		posAngle="-159"	posRadius="52"	posZ="0"	rotation="180"	effect="&efMainThrusterLarge;"/>
			<Effect type="thrustMain"		posAngle="180"	posRadius="48"	posZ="7"	rotation="180"	effect="&efMainThrusterLarge;"/>
		</Effects>

		<!-- AI and Behavior -->

		<AISettings
			fireRateAdj=		"24"
			fireAccuracy=		"95"
			perception=			"5"

			ignoreShieldsDown=	"true"
			/>

	</ShipClass>

	<!-- Slaver, Carrier Earth

	EXTRA DATA

	totalCount:			Total number of Wind slavers
	inFlight:			List of ObjIDs of Wind slavers in flight
	bombardTarget:		Target to bombard

	-->

	<ShipClass UNID="&scCarrierEarthSlaver;"
			manufacturer=		"Sung Empire"
			class=				"Earth Slaver"
			type=				""

			attributes=			"capitalShip, sungSlavers"
			   
			size=				"110"
			mass=				"11000"
			thrustRatio=		"1"
			maxSpeed=			"12"
			cargoSpace=			"500"

			cyberDefenseLevel=	"6"

			explosionType=		"&vtBlastExplosion2;"
			leavesWreck=		"100"
			>

		<!-- Configuration -->
		
		<Armor
			armorID=			"&itHeavySungArmor;"
			count=				"12"
			/>
		
		<Devices>
			<Device deviceID="&itParticleBoltCannon;">
				<Items>
					<Item  count="20d20"	item="&itParticleBoltCartridge;"/>
				</Items>
			</Device>
			<Device deviceID="&itCyberDeckLowerShields;"/>
			<Device deviceID="&itParticleBeamWeapon;" secondaryWeapon="true" minFireArc="350" maxFireArc="190" posAngle="102" posRadius="54" posZ="0"/>
			<Device deviceID="&itParticleBeamWeapon;" secondaryWeapon="true" minFireArc="170" maxFireArc="10" posAngle="-102" posRadius="54" posZ="0"/>
			<Device deviceID="&itYoroiS100;"/>
		</Devices>

		<Maneuver
			maxRotationRate=	"5"
			rotationAccel=		"0.5"
			/>

		<Interior>
			<Compartment name="interior"
					hitPoints=	"100"
					/>
			
			<Compartment name="main drive"
					type=		"mainDrive"
					hitPoints=	"100"

					posX=		"-43"
					posY=		"0"
					sizeX=		"42"
					sizeY=		"68"
					/>
		</Interior>

		<Items>
			<Item				  count="4d6"	item="&itXenotiteFuelRod;"/>
			<Table>
				<Lookup chance="40" count="1" table="&trConsumables6;"/>
				<Lookup chance="40" count="1" table="&trMinorItem6;"/>
				<Lookup chance="20" count="1" table="&trMajorItem6;"/>
			</Table>
		</Items>

		<!-- Image and Effects -->
		
		<Image imageID="&rsMediumShips4;" imageX="384" imageY="0" imageWidth="128" imageHeight="128"/>

		<Effects>
			<Effect type="thrustMain"		posAngle="180"	posRadius="48"	posZ="-7"	rotation="180"	effect="&efMainThrusterLarge;"	sendToBack="*"/>
			<Effect type="thrustMain"		posAngle="159"	posRadius="52"	posZ="0"	rotation="180"	effect="&efMainThrusterLarge;"/>
			<Effect type="thrustMain"		posAngle="-159"	posRadius="52"	posZ="0"	rotation="180"	effect="&efMainThrusterLarge;"/>
			<Effect type="thrustMain"		posAngle="180"	posRadius="48"	posZ="7"	rotation="180"	effect="&efMainThrusterLarge;"/>
		</Effects>

		<!-- AI and Behavior -->
		
		<AISettings
			fireRateAdj=		"20"
			fireAccuracy=		"95"
			perception=			"5"

			ignoreShieldsDown=	"true"
			/>

		<Events>
			<OnCreate>
				(block (totalCount)
					(setq totalCount (random 8 12))
					(objSetData gSource "totalCount" totalCount)
					(objSetData gSource "inFlight" Nil)
					)
			</OnCreate>

			<OnObjDestroyed>
				(switch
					; If the bombard target is destroyed, choose a new target
					(eq aObjDestroyed (objGetObjRefData gSource "bombardTarget"))
						(block Nil
							(objUnregisterForEvents gSource aObjDestroyed)

							(setq aTargetObj (sysFindObject gSource "ATEN +populated;"))
							(if aTargetObj
								(if (gr (objGetDistance gSource aTargetObj) 50)
									(objFireEvent gSource "OrderBombardTarget")
									(block Nil
										(shpCancelOrders gSource)
										(shpOrder gSource 'bombard aTargetObj)
										(objRegisterForEvents gSource aTargetObj)
										(objSetObjRefData gSource "bombardTarget" aTargetObj)
										)
									)
								)
							)

					; Otherwise, it is one of our fighters
					(block (inFlight)
						(setq inFlight (filter (objGetData gSource "inFlight") theObjID 
							(not (eq theObjID (objGetID aObjDestroyed)))
							))
						(objSetData gSource "inFlight" inFlight)
						(objIncData gSource "totalCount" -1)
						)
					)
			</OnObjDestroyed>

			<OnObjEnteredGate>
				(block (inFlight)
					(setq inFlight (filter (objGetData gSource "inFlight") theObjID 
						(not (eq theObjID (objGetID aObj)))
						))
					(objSetData gSource "inFlight" inFlight)
					)
			</OnObjEnteredGate>

			<OrderAttackTarget>
				; aTargetObj is target to attack

				(block (inFlight totalCount)
					(setq totalCount (objGetData gSource "totalCount"))
					(setq inFlight (objGetData gSource "inFlight"))

					; Deploy all slavers in flight
					(enum inFlight theObjID
						(block (theObj)
							(setq theObj (objGetObjByID theObjID))
							(shpCancelOrders theObj)
							(sunAttackTarget gSource theObj aTargetObj)
							(shpOrder theObj 'gate gSource)
							)
						)

					; Deploy the remaining slavers
					(for i 1 (subtract totalCount (count inFlight))
						(block (theObj)
							(setq theObj (sysCreateShip &scWindSlaver; (objGetPos gSource) &svSung;))
							(sunAttackTarget gSource theObj aTargetObj)
							(shpOrder theObj 'gate gSource)

							(objRegisterForEvents gSource theObj)
							(setq inFlight (append inFlight (list (objGetID theObj))))
							)
						)

					(objSetData gSource "inFlight" inFlight)

					; We attack the target
					(shpCancelOrders gSource)
					(shpOrder gSource 'attack aTargetObj)
					)
			</OrderAttackTarget>

			<OrderBombardTarget>
				; aTargetObj is target to attack

				(block (bearing markerObj maxDist)
					; Find the bearing from the target to us
					(setq bearing (sysVectorAngle (sysVectorSubtract (objGetPos gSource) (objGetPos aTargetObj))))
					(setq bearing (add bearing (random -60 60) 360))

					; Pick a point a certain distance from the target
					(setq maxDist 50)
					(setq markerObj (sysCreateMarker "Staging" (sysVectorPolarOffset (objGetPos aTargetObj) bearing maxDist) &svSung;))

					; Go to the staging point
					(shpCancelOrders gSource)
					(shpOrder gSource 'approach markerObj 15)
					(shpOrder gSource 'bombard aTargetObj)

					(objRegisterForEvents gSource aTargetObj)
					(objSetObjRefData gSource "bombardTarget" aTargetObj)

					; Deploy the wing
					(sunOrderWing gSource 'escort gSource)
					)
			</OrderBombardTarget>
		</Events>

	</ShipClass>

	<!-- Slaver, Dragon -->

	<ShipClass UNID="&scDragonSlaver;"
			manufacturer=		"Sung Empire"
			class=				"Dragon Slaver"
			type=				""
			defaultSovereign=	"&svSung;"

			size=				"100"
			mass=				"6000"
			cargoSpace=			"200"
			thrustRatio=		"2.5"
			maxSpeed=			"18"

			level=				"10"
			cyberDefenseLevel=	"8"

			explosionType=		"&vtThermoExplosion2;"

			attributes=			"capitalShip, genericClass, majorShip, sungSlavers"
			>

		<!-- Configuration -->
		
		<Armor
			armorID=			"&itDragonArmor;"
			count=				"12"
			/>
		
		<Devices>
			<Device deviceID="&itQianlongArchcannon;">
				<Items>
					<Item count="1d4" item="&itLongzhuSphere;"/>
				</Items>
			</Device>
			<Device deviceID="&itCyberDeckLowerShields;"/>
			<Device deviceID="&itParticleBeamWeapon;" enhancement="0x0105" secondaryWeapon="true" minFireArc="350" maxFireArc="190" posAngle="50" posRadius="50" posZ="-3"/>
			<Device deviceID="&itParticleBeamWeapon;" enhancement="0x0105" secondaryWeapon="true" minFireArc="170" maxFireArc="10" posAngle="310" posRadius="50" posZ="-3"/>
			<Device deviceID="&itDragonShields;"/>
		</Devices>

		<Maneuver
			maxRotationRate=	"9.0"
			rotationAccel=		"1.0"
			/>

		<Interior>
			<Compartment name="interior"
					hitPoints=	"180"
					/>
			
			<Compartment name="main drive"
					type=		"mainDrive"
					hitPoints=	"80"

					posX=		"0"
					posY=		"0"
					sizeX=		"26"
					sizeY=		"44"
					/>
		</Interior>
		
		<Items>
			<Item				  count="2d6"	item="&itHadronVacuumFuelCell;"/>
			<Table>
				<Lookup chance="40" count="1" table="&trConsumables6;"/>
				<Lookup chance="40" count="1" table="&trMinorItem6;"/>
				<Lookup chance="20" count="1" table="&trMajorItem6;"/>
			</Table>
		</Items>

		<Image imageID="&rsDragonSlaverImage;" imageX="0" imageY="0" imageWidth="128" imageHeight="128"/>

		<Effects>
			<Effect type="thrustMain"		posAngle="90"	posRadius="12"	posZ="0"	rotation="180"	sendToBack="*"/>
			<Effect type="thrustMain"		posAngle="-90"	posRadius="12"	posZ="0"	rotation="180"	sendToBack="*"/>
		</Effects>

		<AISettings
			fireRateAdj=		"10"
			fireAccuracy=		"95"
			perception=			"6"

			combatStyle=		"advanced"
			ignoreShieldsDown=	"true"
			/>

		<Events>
			<OnDestroy>
				(block Nil
					; The wreck always has a damaged Qianlong archcannon
					; We remove the any that were created in the wreck
					(enum (objGetItems aWreckObj "w +qianlongArchcannon;") theItem
						(objRemoveItem aWreckObj theItem)
						)

					; Add a damaged one
					(objAddItem aWreckObj (itmSetDamaged (itmCreate &itQianlongArchcannon; 1)))
					)
			</OnDestroy>
		</Events>
	</ShipClass>

	<!-- Sung Transport -->

	<ShipClass UNID="&scSungTransport;"
			manufacturer=		"Sung Empire"
			class=				"Sung transport"
			type=				""
			defaultSovereign=	"&svSung;"

			size=				"240"
			mass=				"10000"
			cargoSpace=			"7000"
			thrustRatio=		"0.3"
			maxSpeed=			"6"

			explosionType=		"&vtBlastExplosion3;"

			attributes=			"freighter, genericClass, sungSlavers"
			>

		<!-- Configuration -->
		
		<Armor
			armorID=			"&itSungArmor;"
			count=				"20"
			/>
		
		<Devices>
			<Device deviceID="&itParticleBeamWeapon;" omnidirectional="true"/>
			<Device deviceID="&itYoroiS100;"/>
			<Device deviceID="&it100MWReactor;"/>
		</Devices>

		<Maneuver
			maxRotationRate=	"2.0"
			rotationAccel=		"0.2"
			/>

		<Interior>
			<Compartment name="interior"
					hitPoints=	"50"
					/>
			
			<Compartment name="main drive"
					type=		"mainDrive"
					hitPoints=	"50"

					posX=		"-66"
					posY=		"0"
					sizeX=		"60"
					sizeY=		"30"
					/>
			
			<Compartment name="cargo containers"
					type=		"cargo"
					hitPoints=	"150"

					posX=		"10"
					posY=		"0"
					sizeX=		"118"
					sizeY=		"30"
					/>
		</Interior>

		<Items>
			<Item	count="2d6"		item="&itXenotiteFuelRod;"/>
		</Items>

		<Image imageID="&rsSungTransport;" imageWidth="216" imageHeight="216"/>

		<Effects>
			<Effect type="thrustMain"		posAngle="176"	posRadius="80"	posZ="0"	rotation="180"	effect="&efMainThrusterLarge;"	sendToBack="*"/>
			<Effect type="thrustMain"		posAngle="-176"	posRadius="80"	posZ="0"	rotation="180"	effect="&efMainThrusterLarge;"	sendToBack="*"/>
		</Effects>

		<AISettings
			fireRateAdj=		"20"
			fireAccuracy=		"90"
			perception=			"4"
			
			combatStyle=		"standOff"
			/>

	</ShipClass>

<!-- ITEM TYPES -->

<!-- LEVEL IX ITEMS -->

	<!-- Qianlong Archcannon -->

	<ItemType UNID="&itQianlongArchcannon;"
			name=				"Qianlong archcannon"
			level=				"9"
			value=				"220000"
			mass=				"2500"
			frequency=			"notrandom"
			attributes=			"MajorItem; Military; NotForSale; qianlongArchcannon; sungSlavers"

			charges=			"32"
			description=		"The pinnacle of Sung Slaver technology, the Qianlong archcannon fires antimatter shells. The archcannon recharges with longzhu spheres."
			>

		<Image imageID="&rsItems9;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"antimatter:8d12; WMD:7"
				fireRate=			"16"
				missileSpeed=		"40"
				hitPoints=			"5"
				lifetime=			"113"
				powerUse=			"100"
				charges=			"true"

				effect=				"&efQianlongProjectile;"
				fireEffect=			"&efQianlongFire;"
				hitEffect=			"&efQianlongHit;"
				sound=				"&snRecoillessCannon;"
				>
		</Weapon>

		<Events>
			<OnAIUpdate>
				(if (and (leq (itmGetCharges gItem) 256)
						(objGetItems gSource "u +LongzhuSphere;"))
					(block Nil
						(setq aCharges 256)
						(objFireItemEvent gSource gItem "Recharge")
						(objRemoveItem gSource (itmCreate &itLongzhuSphere; 1))
						)
					)
			</OnAIUpdate>
			
			<Recharge>
				; aCharges = amount to recharge
				; Returns the amount recharged
				(block (rechargeNeeded)
					(setq rechargeNeeded (min aCharges (subtract 9999 (itmGetCharges gItem))))
					(if (gr rechargeNeeded 0)
						(shpRechargeItem gSource gItem rechargeNeeded)
						)
					rechargeNeeded
					)
			</Recharge>
		</Events>

		<Language>
			<Text id="core.charges">charge(s)</Text>
		</Language>
	</ItemType>

<!-- LEVEL VII ITEMS -->

	<!-- Segment of Dragon Armor -->

	<ItemType UNID="&itDragonArmor;"
			inherit=			"&baSungArmor;"
			name=				"[segment(s) of ]Dragon armor"
			level=				"7"
			value=				"5000"
			frequency=			"notRandom"
			numberAppearing=	"1d4"
			mass=				"6500"
			attributes=			"Military; MinorItem; NotForSale; sungSlavers; TiledArmor"

			description=		"This is a heavier version of the Sung's innovative armor, used on its Dragon slavers."

			useScreen=			"&dsRPGUseItemOnArmor;"
			useUninstalledOnly=	"true"

			sortName=			"Sung armor.10"
			>

		<Image imageID="&rsItems2;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"250"
				hpBonus=	"  +0,  +0, +50,+100,  +0, +25"

				repairTech=	"6"

				blindingDamageAdj="0"
				deviceDamageAdj="0"
				EMPDamageAdj=	"0"
				radiationImmune="true"
				/>

		<StaticData>
			<Data id="RepairHP">125</Data>
		</StaticData>
	</ItemType>

	<!-- Dragon Shields -->

	<ItemType UNID="&itDragonShields;"
			name=				"Dragon shield generator"
			level=				"7"
			value=				"50000"
			mass=				"6000"
			frequency=			"notRandom"
			attributes=			"majorItem, military, notForSale; sungSlavers"

			description=		"Used by the Sung Dragon slavers, these shields are a much enhanced version of the Yoroi S500."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"140"
				hpBonus=		"  +0,+100,  +0,+400,  +0,+100"
				regen=			"60"
				depletionDelay=	"480"
				powerUse=		"500"
				/>

	</ItemType>

<!-- LEVEL VI ITEMS -->

	<!-- CyberDeck (Lower Shields) -->

	<ItemType UNID="&itCyberDeckLowerShields;"
			name=				"CyberDeck lower shields"
			virtual=			"true"
			level=				"6"
			>

		<CyberDeckDevice
				range=			"30"
				attackChance=	"20"
				aiLevel=		"6"
				program=		"ShieldsDown"
				programName=	"Shi3ldsDown 3.1.5"
				/>

	</ItemType>

	<!-- Longzhu Sphere -->

	<ItemType UNID="&itLongzhuSphere;"
			inherit=			"&baStdDeviceEnhancement;"
			name=				"longzhu sphere"
			level=				"6"
			value=				"500"
			mass=				"1"
			frequency=			"rare"
			numberAppearing=	"1"
			attributes=			"antiMatter, confirmRefuel, consumable, fuel, 100MW, longzhuSphere, notStandardFuel, sungSlavers"

			useScreen=			"&dsRPGUseItemOnDevice;"
			data=				"500000"

			description=		"Longzhu spheres are antimatter containment vessels used by the Sung Slavers as power sources."
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="288" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancementTable">
				(
					{	criteria:"Ds L:1-10; -nonEnergyShields;"	repair:True	}
					{	criteria:"Dw L:1-10; +EnergyWeapon;"		repair:True	}
					{	criteria:"s L:1-10; -nonEnergyShields;"	enhancement:"+hpBonus:20"	}
					{	criteria:"w L:1-10; +EnergyWeapon;"		enhancement:"+hpBonus:20"	}
					{	criteria:"v L:1-10; -Alien;"	enhancement:Nil	}
					)
			</Data>
		</StaticData>

		<Events>
			<OnUseOnItem>
				(block (
					(dstItem (@ gData 'itemToUseOn))
					)
					(switch
						;	Recharge Qianlong Archcannon
						(= (itmGetType dstItem) &itQianlongArchcannon;)
							(block (recharged)
								(setq recharged (objFireItemEvent gPlayerShip gItem 'Recharge 256))

								;	Remove the item from the player's cargo
								(objRemoveItem gPlayerShip gItem 1)

								(if (= recharged 0)
									(itmTranslate gItem 'descNoRecharge)
									(itmTranslate gItem 'descRecharge)
									)
								)

						;	Call default handler
						(typFireEvent &baStdDeviceEnhancement; 'OnUseOnItem gData)
						)
					)
			</OnUseOnItem>
		</Events>

		<Language>
			<Text id="descResultIntro">

				The longzhu sphere glows with stored power and the %dstItem%
				hums with new energy.

			</Text>
			<Text id="descNoRecharge">

				The longzhu sphere glows with stored power but the Qianlong
				archcannon is unaffected.

			</Text>
			<Text id="descRecharge">

				The longzhu sphere glows with stored power and the Qianlong
				archcannon hums with new energy. Your Qianlong archcannon has
				been recharged.

			</Text>
			<Text id="descNoFurther">The enhancement has no effect.</Text>
		</Language>
	</ItemType>

	<!-- Particle Bolt Cannon -->

	<ItemType UNID="&itParticleBoltCannon;"
			name=				"Nandao bolt cannon"
			level=				"6"
			value=				"25000"
			mass=				"2000"
			frequency=			"rare"
			numberAppearing=	"1"
			attributes=			"MajorItem; Military; NotForSale; sungSlavers"

			description=		"The Nandao bolt cannon fires a sublight pulse of heavy ions. The weapon requires Nandao bolt cartridges."
			>

		<Image imageID="&rsItems6;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>

		<Weapon
				fireRate=			"30"
				powerUse=			"40"
				>

			<Missiles>
				<Missile ammoID="&itParticleBoltCartridge;"
						type=			"missile"

						lifetime=		"80"
						damage=			"particle:15d8; WMD:4"
						hitPoints=		"15"

						missileSpeed=	"60"
						sound=			"&snRecoillessCannon;"
						>

					<Effect>
						<Starburst
								spikeCount=		"1d6+2"
								spikeLength=	"30-50"
								primaryColor=	"#65ff2c"
								secondaryColor=	"#808417"
								/>
						
						<Orb
								style=			"smooth"
								radius=			"40"
								intensity=		"20"
								primaryColor=	"#65ff2c"
								secondaryColor=	"#65ff2c"
								/>
					</Effect>
				</Missile>
			</Missiles>
		</Weapon>
	</ItemType>

	<!-- Particle bolt cartridge -->

	<ItemType UNID="&itParticleBoltCartridge;"
			name=				"Nandao bolt cartridge"
			level=				"6"
			value=				"35"
			mass=				"10"
			frequency=			"common"
			numberAppearing=	"20d40"
			attributes=			"Consumable; Missile; NotForSale; sungSlavers"

			description=		"This energy cartridge is used by the Nandao bolt cannon."

			sortName=			"~.Nandao bolt cartridge"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Segment of Heavy Sung Armor -->

	<ItemType UNID="&itHeavySungArmor;"
			inherit=			"&baSungArmor;"
			name=				"[segment(s) of ]super-heavy Sung armor"
			level=				"6"
			value=				"2300"
			frequency=			"rare"
			numberAppearing=	"1d4"
			mass=				"7500"
			attributes=			"MinorItem; NotForSale; sungSlavers; TiledArmor"

			description=		"This is a heavier version of the Sung's innovative armor, generally used on its Earth slavers."

			useScreen=			"&dsRPGUseItemOnArmor;"
			useUninstalledOnly=	"true"

			sortName=			"Sung armor.20"
			>

		<Image imageID="&rsItems2;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"180"
				hpBonus=	"  +0,  +0, -25, +50,  +0, +25"

				blindingDamageAdj="0"
				deviceDamageAdj="25"
				EMPDamageAdj=	"10"
				/>

		<StaticData>
			<Data id="RepairHP">90</Data>
		</StaticData>
	</ItemType>

<!-- LEVEL V ITEMS -->

	<!-- CyberDeck (Disarm) -->

	<ItemType UNID="&itCyberDeckDisarm;"
			name=				"CyberDeck disarm"
			virtual=			"true"
			level=				"5"
			>

		<CyberDeckDevice
				range=			"20"
				attackChance=	"20"
				aiLevel=		"5"
				program=		"Disarm"
				programName=	"Brok3nArms 1.1"
				/>

	</ItemType>

	<!-- Segment of Sung Armor -->

	<ItemType UNID="&itSungArmor;"
			inherit=			"&baSungArmor;"
			name=				"[segment(s) of ]Sung armor"
			level=				"5"
			value=				"600"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			mass=				"3000"
			attributes=			"MinorItem; NotForSale; sungSlavers; TiledArmor"

			description=		"This blast-resistant tiled armor can be cannibalized to repair other Sung armor segments."

			useScreen=			"&dsRPGUseItemOnArmor;"
			useUninstalledOnly=	"true"

			sortName=			"Sung armor.30"
			>

		<Image imageID="&rsItems2;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"70"
				hpBonus=	"  +0,  +0, -25, +50,  +0"

				repairTech=	"6"

				blindingDamageAdj="0"
				deviceDamageAdj="50"
				EMPDamageAdj=	"25"
				/>

		<StaticData>
			<Data id="RepairHP">35</Data>
		</StaticData>
	</ItemType>
	
<!-- LEVEL II ITEMS -->

	<!-- Segment of Light Sung Armor -->

	<ItemType UNID="&itLightSungArmor;"
			inherit=			"&baSungArmor;"
			name=				"[segment(s) of ]light Sung armor"
			level=				"2"
			value=				"60"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			mass=				"1500"
			attributes=			"MinorItem; NotForSale; sungSlavers; TiledArmor"

			description=		"The Sung created this blast-resistant tiled armor for their Wind slavers. The tiles can be cannibalized to repair other Sung armor segments."

			useScreen=			"&dsRPGUseItemOnArmor;"
			useUninstalledOnly=	"true"

			sortName=			"Sung armor.40"
			>

		<Image imageID="&rsItems2;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"25"
				hpBonus=	"  +0,  +0, -25, +50,  +0"

				repairTech=	"6"

				blindingDamageAdj="0"
				EMPDamageAdj=	"25"
				/>

		<StaticData>
			<Data id="RepairHP">12</Data>
		</StaticData>
	</ItemType>

<!-- MISCELLANEOUS -->

	<!-- Sung Encounter Table -->

	<ShipTable unid="&tbSungEncounters;">
		<LevelTable>
			<Ship levelFrequency="--ucu r----" count="1"	 class="&scWindSlaver;" eventHandler="&evStdPatrolEncounterBehavior;">
				<Escorts>
					<Ship					   count="1d4-1" class="&scWindSlaver;" orders="escort"/>
				</Escorts>
			</Ship>

			<Ship levelFrequency="---rc uu---" count="1"	 class="&scWindSlaver;" eventHandler="&evStdPatrolEncounterBehavior;">
				<Escorts>
					<Ship					   count="2d3"	 class="&scWindSlaver;" orders="escort"/>
				</Escorts>
			</Ship>

			<Ship levelFrequency="----r ur---" count="1"	 class="&scSteelSlaver;" eventHandler="&evStdPatrolEncounterBehavior;">
				<Escorts>
					<Ship					   count="1d4"	 class="&scWindSlaver;" orders="escort"/>
				</Escorts>
			</Ship>

			<Ship levelFrequency="--rru ur---" count="1"	 class="&scSungTransport;" eventHandler="&evStdConvoyEncounterBehavior;">
				<Items>
					<Table>
						<RandomItem chance="15" count="1d3" levelFrequency="ucccc uv---" criteria="a +sungSlavers;" />
						<Item		chance="10" count="1"	item="&itLongzhuSphere;"/>
						<Item		chance="10" count="4d8"	item="&itParticleBoltCartridge;"/>
						<Item		chance="20" count="1d8"	item="&itSlaveCoffin;"/>
						<Item		chance="5" count="1d12" item="&itCeralloyOre;"/>
						<Item		chance="5" count="1d12" item="&itXenotiteOre;"/>
						<Item		chance="5" count="1d12" item="&itPteracniumOre;"/>
						<Lookup chance="15" count="1d4" table="&trConsumables5;"/>
						<Lookup chance="10" count="1" table="&trMinorItem5;"/>
						<Lookup chance="5" count="1" table="&trMajorItem5;"/>
					</Table>
				</Items>

				<Escorts>
					<Ship					   count="2d4"	 class="&scWindSlaver;" orders="escort"/>
				</Escorts>
			</Ship>
		</LevelTable>
	</ShipTable>

	<Globals>
		(block Nil
			(setq sunAttackTarget (lambda (theCarrier theShip theTarget)
				(if (objIsShip theTarget)
					(shpOrder theShip 'attack theTarget)
					(shpOrder theShip 'escort theCarrier)
					)
				))

			(setq sunOrderWing (lambda (theCarrier theOrder theTarget)
				(block (totalCount inFlight)
					(setq totalCount (objGetData theCarrier "totalCount"))
					(setq inFlight (objGetData theCarrier "inFlight"))

					; Deploy the remaining slavers
					(if (not (eq theOrder 'gate))
						(for i 1 (subtract totalCount (count inFlight))
							(block (theObj)
								(setq theObj (sysCreateShip &scWindSlaver; (objGetPos theCarrier) &svSung;))

								(objRegisterForEvents theCarrier theObj)
								(setq inFlight (append inFlight (list (objGetID theObj))))
								)
							)
						)

					; Order all slavers in flight
					(enum inFlight theObjID
						(block (theObj)
							(setq theObj (objGetObjByID theObjID))
							(shpCancelOrders theObj)
							(shpOrder theObj theOrder theTarget)
							)
						)

					(objSetData theCarrier "inFlight" inFlight)
					)
				))
			)
	</Globals>

<!-- BASE CLASSES -->

	<Type unid="&baSungArmor;"
			inherit=			"&baStdArmorRepair;"
			>
		<Events>
			<CanRepairItem>
				(itmMatches aItemToRepair "a +TiledArmor")
			</CanRepairItem>
		</Events>
	</Type>
	
<!-- EFFECTS -->
	
	<EffectType unid="&efQianlongProjectile;"
			instance=			"creator"
			>
		<Effect>
			<ParticleSystem
					style=				"radiate"
					emitSpeed=			"10-20"
					>
				<ParticleEffect>
					<Orb
							instance=			"owner"
						
							style=				"smooth"
							animate=			"fade"
							radius=				"10"
							intensity=			"20"
						
							blendMode=			"screen"
							primaryColor=		"#ff6a00"
							secondaryColor=		"#ff2a00"
							>
						<Events>
							<GetParameters>
								(block (
									(damageHP (@ gData 'damageHP))
									)
									{
										lifetime: (mathScale damageHP 50 680 4 12 50)
										}
									)
							</GetParameters>
						</Events>
					</Orb>
				</ParticleEffect>
				
				<Events>
					<GetParameters>
						(block (
							(damageHP (@ gData 'damageHP))
							)
							{
								emitRate: (mathScale damageHP 50 680 20 100 50)
								particleLifetime: (mathScale damageHP 50 680 4 12 50)
								}
							)
					</GetParameters>
				</Events>
			</ParticleSystem>

			<Orb
					style=				"smooth"
					animate=			"flicker"
					spikeCount=			"6"
						
					blendMode=			"screen"
					primaryColor=		"#ffa666"
					secondaryColor=		"#ff6a00"
					>
				<Events>
					<GetParameters>
						(block (
							(damageHP (@ gData 'damageHP))
							)
							{
								radius: (mathScale damageHP 50 680 20 60 50)
								intensity: (mathScale damageHP 50 680 20 50 50)
								}
							)
					</GetParameters>
				</Events>
			</Orb>
		</Effect>
	</EffectType>
	
	<EffectType UNID="&efQianlongFire;"
			instance=			"owner"
			>
		<Effect>
			<Orb	style=			"smooth"
					animate=		"fade"
					lifetime=		"9"
					spikeCount=		"6"
					
					primaryColor=	"#ffa666"
					secondaryColor=	"#ff6a00"
					>
				<Events>
					<GetParameters>
						(block (
							(damageHP (@ gData 'damageHP))
							)
							
							{
								radius: (mathScale damageHP 50 680 30 80 50)
								intensity: (random 20 50)
								}
							)
					</GetParameters>
				</Events>
			</Orb>
		</Effect>
	</EffectType>

	<EffectType UNID="&efQianlongHit;"
			sound="&snArmorHit1;"
			>
		<Effect>
			<Orb	style=			"smooth"
					animate=		"fade"
					intensity=		"30"
					
					blendMode=		"screen"
					primaryColor=	"#ffa666"
					secondaryColor=	"#ff6a00"
					>
				<Events>
					<GetParameters>
						(block (
							(damageHP (@ gData 'damageHP))
							)
							{
								radius: (if (= damageHP 0) 10 (mathScale damageHP 50 680 50 100 50))
								lifetime: (if (= damageHP 0) 4 (mathScale damageHP 50 680 24 60 50))
								}
							)
					</GetParameters>
				</Events>
			</Orb>
			
			<ParticleSystem
					style=				"radiate"
					emitLifetime=		"1"
					emitSpeed=			"10-20"
					>
				<ParticleEffect>
					<Orb
							instance=			"owner"
						
							style=				"smooth"
							animate=			"fade"
							radius=				"10"
							intensity=			"20"
						
							blendMode=			"screen"
							primaryColor=		"#ffa666"
							secondaryColor=		"#ff6a00"
							>
						<Events>
							<GetParameters>
								(block (
									(damageHP (@ gData 'damageHP))
									)
									{
										lifetime: (mathScale damageHP 50 680 12 30 50)
										}
									)
							</GetParameters>
						</Events>
					</Orb>
				</ParticleEffect>
				
				<Events>
					<GetParameters>
						(block (
							(damageHP (@ gData 'damageHP))
							)
							{
								emitRate: (mathScale damageHP 50 680 30 100 50)
								particleLifetime: (mathScale damageHP 50 680 12 30 50)
								}
							)
					</GetParameters>
				</Events>
			</ParticleSystem>
		</Effect>
		
		<Events>
			<GetParameters>
				(block (
					(damageHP (@ gData 'damageHP))
					)
					{
						noSound: (= damageHP 0)
						}
					)
			</GetParameters>
		</Events>
	</EffectType>
	
<!-- RESOURCES -->

	<Image UNID="&rsDragonSlaverImage;"	bitmap="Resources\DragonSlaver.jpg"		bitmask="Resources\DragonSlaverMask.bmp"  loadOnUse="true"/>
	<Image UNID="&rsSungTransport;"		bitmap="Resources\SungTransport.jpg"	bitmask="Resources\SungTransportMask.bmp"  loadOnUse="true"/>
	<Image UNID="&rsWindSlaverHD;"		bitmap="Resources\WindSlaverHD.jpg"		bitmask="Resources\WindSlaverHDMask.bmp"  loadOnUse="true"/>
	<Image UNID="&rsSteelSlaverHD;"		bitmap="Resources\SteelSlaverHD.jpg"	bitmask="Resources\SteelSlaverHDMask.bmp"  loadOnUse="true"/>

</TranscendenceModule>
