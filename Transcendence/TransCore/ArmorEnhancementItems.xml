<?xml version="1.0" encoding="utf-8"?>

<TranscendenceModule>

<!-- LEVEL 1 -->

	<!-- Level 1: Ablative Armor Coating -->

	<ItemType UNID="&itAblativeArmorCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]ablative armor coating"
			level=				"1"
			value=				"40"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem"
			unknownType=		"&itUnknownBarrel;"

			description=		"This coating is used to protect a ship's armor against laser and particle beam weapons."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"ablative"

			sortName=			"ablative armor coating, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x0a05</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The paste is an ablative coating that resists laser and particle damage.
			</Text>
		</Language>
	</ItemType>

	<!-- Level 1: Reactive Armor Coating -->

	<ItemType UNID="&itReactiveArmorCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]reactive armor coating"
			level=				"1"
			value=				"60"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			unknownType=		"&itUnknownBarrel;"
			attributes=			"ArmorEnhance; MinorItem"

			description=		"This coating reacts when hit by kinetic or chemical explosives and produces an opposite reaction that protect the underlying armor and hull."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"reactive"

			sortName=			"reactive armor coating, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x0a15</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The paste is a reactive coating that resists kinetic and chemical explosion damage.
			</Text>
		</Language>
	</ItemType>

<!-- LEVEL 2 -->

	<!-- Level 2: Carbon-Weaver Nanos -->

	<ItemType UNID="&itCarbonWeaverNanos;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]carbon-weaver nanos"
			level=				"2"
			value=				"80"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			unknownType=		"&itUnknownBarrel;"
			attributes=			"ArmorEnhance; MinorItem"

			description=		"The nanomachines in this paste weave a strong carbon grid through a ship's armor. Armor that has been treated in this way will be stronger and more resistant to damage."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"carbon-weave"

			sortName=			"carbon-weaver nanos, barrel of"
			>

		<Properties>
			<Constant id="rpg.enhancementTable">
				'(
					{	criteria:"a &lt;=3"	enhancement:0x0105	}
					{	criteria:"a &lt;=5"	enhancement:0x0103	}
					{	criteria:"a &lt;=6"	enhancement:0x0101	}
					{	criteria:"a &gt;6"	enhancement:Nil	descID:'TooAdvanced	}
					)
			</Constant>
		</Properties>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Language>
			<Text id="descResultIntro">
				The coating is composed of nanomachines that strengthen your armor.
			</Text>
		</Language>
	</ItemType>

	<!-- Level 2: Organic Acid -->

	<ItemType UNID="&itOrganicAcid;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]organic acid"
			level=				"2"
			value=				"15"
			mass=				"1000"
			frequency=			"common"
			numberAppearing=	"1d4"
			unknownType=		"&itUnknownBarrel;"
			attributes=			"armorDamage, consumable, res"

			description=		"Powerful organic acids such as these are used in various industrial processes. Use with caution: Do not allow contact with a ship's armor or hull."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"acid"

			sortName=			"organic acid, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Properties>
			<Constant id="rpg.useCriteria">"a"</Constant>
		</Properties>

		<Events>
			<OnUseOnItem>
				(block (
					(dstItem (@ gData 'itemToUseOn))
					)
					(setq dstItem (objSetItemProperty gPlayerShip dstItem 'incHP (- (rollDice 3 6 0))))

					;	Remove the armor paste from the player's cargo
					(objRemoveItem gPlayerShip gItem 1)

					;	Identify the item
					(itmSetKnown gItem)

					;	If the armor was destroyed, then we remove it too.

					(if (and (not (itmGetProperty dstItem 'installed))
							(= (itmGetProperty dstItem 'hp) 0)
							)
						(block ()
							(objRemoveItem gPlayerShip dstItem)

							{
								desc: (itmTranslate gItem 'descResultDestroyed)
								}
							)

						{
							desc: (itmTranslate gItem 'descResult)
							}
						)
					)
			</OnUseOnItem>
		</Events>

		<Language>
			<Text id="descResult">

				Unfortunately, the barrel contained an organic acid that eats
				through most metals. The armor segment has been damaged.

			</Text>
			<Text id="descResultDestroyed">

				Unfortunately, the barrel contained an organic acid that eats
				through most metals. The armor segment has been destroyed.

			</Text>
		</Language>
	</ItemType>

<!-- LEVEL 3 -->

	<!-- Level 3: Decon Gel -->

	<ItemType UNID="&itDeconGel;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]decon gel"
			level=				"3"
			value=				"150"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"Consumable"
			unknownType=		"&itUnknownBarrel;"

			description=		"Decon gel is used to decontaminate radioactive metals, ceramics and other materials. It is ideal for decontaminating a ship's armor and hull."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"decon"

			sortName=			"decon gel, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Properties>
			<Constant id="rpg.useCriteria">"a"</Constant>
		</Properties>

		<Events>
			<OnUseOnItem>
				(block (
					(dstItem (@ gData 'itemToUseOn))
					resultID
					)

					(switch
						;	If applied on a loose segment, then no effect

						(not (itmGetProperty dstItem 'installed))
							(setq resultID 'descResultNoEffect)

						;	If ship is radioactive, then we decontaminate

						(shpIsRadioactive gPlayerShip)
							(block Nil
								(shpDecontaminate gPlayerShip)
								(setq resultID 'descResultDecontaminated)
								)

						(setq resultID 'descResultNotNeeded)
						)

					(objRemoveItem gPlayerShip gItem 1)
					(itmSetKnown gItem)
					{
						nextScreen: 'exitScreen
						desc: (itmTranslate gItem resultID {
							dstItem: (itmGetName dstItem)
							})
						}
					)
			</OnUseOnItem>
		</Events>

		<Language>
			<Text id="descResultDecontaminated">

				The barrel was filled with a decontamination gel. Your ship has 
				been decontaminated.

			</Text>
			<Text id="descResultNotNeeded">

				The barrel was filled with a decontamination gel. Since your 
				ship is not radioactive, the gel had no effect.

			</Text>
			<Text id="descResultNoEffect">

				The barrel was filled with a decontamination gel. It had no 
				effect on the %dstItem% because it is not radioactive.

			</Text>
		</Language>
	</ItemType>

	<!-- Level 3: Particle Resistance Coating -->

	<ItemType UNID="&itParticleResistCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]particle resistance coating"
			level=				"3"
			value=				"100"
			mass=				"1000"
			frequency=			"common"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem"
			unknownType=		"&itUnknownBarrel;"

			description=		"This coating is used to protect a ship's armor against particle beam weapons."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"particleresist"

			sortName=			"particle resistance coating, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x0925</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The paste is a coating that resists particle damage.
			</Text>
		</Language>
	</ItemType>

	<!-- Level 3: Plasteel Nanos -->

	<ItemType UNID="&itPlasteelNanos;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]plasteel nanos"
			level=				"3"
			value=				"200"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			unknownType=		"&itUnknownBarrel;"
			attributes=			"ArmorEnhance; MinorItem"

			description=		"The nanomachines in this paste create a hard plasteel shell on top of armor segments."

			useScreen=			"&dsRPGUseItemOnArmor;"
			>

		<Properties>
			<Constant id="core.enhancement">"+hpBonus"</Constant>
		</Properties>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Language>
			<Text id="descResultIntro">
				The coating is composed of plasteel nanomachines that strengthen your armor.
			</Text>
		</Language>
	</ItemType>

	<!-- Level 3: Reflective Armor Coating -->

	<ItemType UNID="&itReflectiveArmorCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]reflective armor coating"
			level=				"3"
			value=				"160"
			mass=				"1000"
			frequency=			"rare"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem; Specialty"
			unknownType=		"&itUnknownBarrel;"

			description=		"This coating is nearly perfectly reflective at all laser weapon wavelengths. A ship's armor coated with this substance will be immune to laser weapons."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"reflective"

			sortName=			"reflective armor coating, barrel of"
			>

		<Properties>
			<Constant id="core.enhancement">"+reflect:laser"</Constant>
		</Properties>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Language>
			<Text id="descResultIntro">
				The paste is a mirrored coating that reflects laser beams.
			</Text>
		</Language>
	</ItemType>

<!-- LEVEL 4 -->

	<!-- Level 4: Anti-Radiation Coating -->

	<ItemType UNID="&itRadiationImmuneCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]anti-radiation coating"
			level=				"4"
			value=				"350"
			mass=				"1000"
			frequency=			"rare"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem"
			unknownType=		"&itUnknownBarrel;"

			description=		"This borocarbide coating absorbs deadly radiation before it can penetrate your ship's hull."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"radiationimmune"

			sortName=			"anti-radiation coating, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">"+immunity:radiation"</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The barrel contains a borocarbide paste that resists radiation.
			</Text>
		</Language>
	</ItemType>

	<!-- Level 4: Degenerating Nanos -->

	<ItemType UNID="&itDegeneratingNanos;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]degenerating nanos"
			level=				"4"
			value=				"25"
			mass=				"1000"
			unknownType=		"&itUnknownBarrel;"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"armorDamage, consumable"

			description=		"These nanomachines are used to recycle old ships and armors into their basic components. Use with caution: Do not allow contact with a ship's armor or hull."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"degenerating"

			sortName=			"degenerating nanos, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x8200</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The paste is a nanomachine matrix that dissolves metals and composites.
			</Text>
		</Language>
	</ItemType>

	<!-- Level 4: Radioactive Waste -->

	<ItemType UNID="&itRadioactiveWaste;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]radioactive waste"
			level=				"4"
			value=				"0"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"Consumable; CannotOrder"
			unknownType=		"&itUnknownBarrel;"

			description=		"This is a titanium barrel filled with low and medium-level radioactive waste."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"radioactive"

			sortName=			"radioactive waste, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Properties>
			<Constant id="rpg.useCriteria">"a"</Constant>
		</Properties>

		<Events>
			<OnUseOnItem>
				(block (
					(dstItem (@ gData 'itemToUseOn))
					resultID
					)
					(switch
						;	Already contaminated
						(shpIsRadioactive gPlayerShip)
							(setq resultID 'descResultAlreadyContaminated)

						;	Applied to an installed armor segment with radiation immunity
						(and (itmMatches dstItem "aI") (shpIsRadiationImmune gPlayerShip dstItem))
							(setq resultID 'descResultImmune)

						(block Nil
							(if (itmMatches dstItem "aI")
								(setq resultID 'descResultContaminated)
								(setq resultID 'descResultContaminatedCargo)
								)
							(shpMakeRadioactive gPlayerShip)
							)
						)

						(objRemoveItem gPlayerShip gItem 1)
						(itmSetKnown gItem)
						{
							nextScreen: 'forceUndock
							desc: (typTranslate &itRadioactiveWaste; resultID)
							}
						)
					)
			</OnUseOnItem>
		</Events>

		<Language>
			<Text id="descResultAlreadyContaminated">

				The barrel contained radioactive waste. Your ship is already
				radioactive; the waste has no further effect.

			</Text>
			<Text id="descResultContaminated">

				The barrel contained radioactive waste. Your ship has been
				contaminated.

			</Text>
			<Text id="descResultImmune">

				The barrel contained radioactive waste. Fortunately, your armor
				is immune to radiation. The waste has no effect.

			</Text>
			<Text id="descResultContaminatedCargo">

				The barrel contained radioactive waste which just emptied inside
				your cargo hold. Your ship has been contaminated.

			</Text>
		</Language>
	</ItemType>

	<!-- Level 4: Regenerating Nanos -->

	<ItemType UNID="&itRegeneratingNanos;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]regenerating nanos"
			level=				"4"
			value=				"350"
			mass=				"1000"
			frequency=			"rare"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem; Specialty"
			unknownType=		"&itUnknownBarrel;"

			description=		"The nanomachines are able to automatically regenerate any armor. Once treated with this paste an armor segment will continue to regenerate even if damaged further."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"regenerating"

			sortName=			"regenerating nanos, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Properties>
			<Constant id="rpg.enhancementTable">
				'(
					{	criteria:"a &lt;=10"	enhancement:0x0200	}
					{	criteria:"a &gt;10"	enhancement:Nil	descID:'TooAdvanced	}
					)
			</Constant>
		</Properties>

		<Language>
			<Text id="descResultIntro">
				The paste is a nanomachine matrix that regenerates the armor segment.
			</Text>
		</Language>
	</ItemType>

<!-- LEVEL 5 -->

	<!-- Level 5: EMP Immunity Coating -->

	<ItemType UNID="&itEMPImmuneCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]monopole dust"
			level=				"5"
			value=				"700"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem"
			unknownType=		"&itUnknownBarrel5;"

			description=		"When applied to armor, monopole dust dissipates EMP energy, rendering it harmless."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"EMPimmune"

			sortName=			"monopole dust, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x0b20</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The barrel contains monopole dust, which protects your armor against EMP effects.
			</Text>
		</Language>
	</ItemType>

	<!-- Level 5: Particle Reflect Coating -->

	<ItemType UNID="&itParticleReflectCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]particle-reflect coating"
			level=				"5"
			value=				"400"
			mass=				"1000"
			frequency=			"rare"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem; Specialty"
			unknownType=		"&itUnknownBarrel;"

			description=		"This coating reflects particle beams."

			useScreen=			"&dsRPGUseItemOnArmor;"
			>

		<Properties>
			<Constant id="core.enhancement">"+reflect:particle"</Constant>
		</Properties>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Language>
			<Text id="descResultIntro">
				The paste is a coating that reflects particle beams.
			</Text>
		</Language>
	</ItemType>

<!-- LEVEL 6 -->

	<!-- Level 6: Ion Resistant Coating -->

	<ItemType UNID="&itIonResistCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]ion resistance coating"
			level=				"6"
			value=				"1300"
			mass=				"1000"
			frequency=			"common"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem"
			unknownType=		"&itUnknownBarrel5;"

			description=		"This coating is used to protect a ship's armor against ion damage."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"ionresist"

			sortName=			"ion resistance coating, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x0945</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The paste is a coating that resists ion damage.
			</Text>
		</Language>
	</ItemType>

	<!-- Level 6: Meteorsteel Dust -->

	<ItemType UNID="&itShieldInterfereCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]meteorsteel dust"
			level=				"6"
			value=				"200"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"armorDamage, minorItem"
			unknownType=		"&itUnknownBarrel5;"

			description=		"Meteorsteel interferes with most kinds of shield generators."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"shieldresist"

			sortName=			"meteorsteel dust, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x8c00</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The barrel contains meteorsteel dust.
			</Text>
		</Language>
	</ItemType>

<!-- LEVEL 7 -->

	<!-- Level 7: Dyon Dust -->

	<ItemType UNID="&itIonEffectImmuneCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]dyon dust"
			level=				"7"
			value=				"2800"
			mass=				"1000"
			frequency=			"rare"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem"
			unknownType=		"&itUnknownBarrel5;"

			description=		"Dust activated by dyons immunizes armor against ion effects that disable or damage a ship's systems."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"ioneffectimmune"

			sortName=			"dyon dust, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x0c00</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The barrel contains dyon dust, which immunizes your armor against disabling ion effects.
			</Text>
		</Language>
	</ItemType>

<!-- LEVEL 8 -->

	<!-- Level 8: Ithalium Paste -->

	<ItemType UNID="&itThermoResistCoating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]ithalium paste"
			level=				"8"
			value=				"5250"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem"
			unknownType=		"&itUnknownBarrel5;"

			description=		"This coating is used to protect a ship's armor against thermonuclear damage."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"thermoresist"

			sortName=			"ithalium paste, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<StaticData>
			<Data id="enhancement">0x0955</Data>
		</StaticData>

		<Language>
			<Text id="descResultIntro">
				The paste is a coating that resists thermonuclear damage.
			</Text>
		</Language>
	</ItemType>

<!-- LEVEL 9 -->

	<!-- Level 9: Orthosteel Nanos -->

	<ItemType UNID="&itCarbonWeaver2Coating;"
			inherit=			"&baStdPasteBarrel;"
			name=				"[barrel(s) of ]orthosteel nanos"
			level=				"9"
			value=				"9000"
			mass=				"1000"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"ArmorEnhance; MinorItem"
			unknownType=		"&itUnknownBarrel5;"

			description=		"The nanomachines in this paste weave a strong orthosteel grid through a ship's armor. Armor that has been treated in this way will be stronger and more resistant to damage."

			useScreen=			"&dsRPGUseItemOnArmor;"
			data=				"carbon-weave2"

			sortName=			"orthosteel nanos, barrel of"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="96" imageWidth="96" imageHeight="96"/>

		<Properties>
			<Constant id="rpg.enhancementTable">
				'(
					{	criteria:"a &lt;=6"	enhancement:Nil	descID:'TooPrimitive	}
					{	criteria:"a &lt;=10"	enhancement:0x0105	}
					{	criteria:"a &gt;10"	enhancement:Nil	descID:'TooAdvanced	}
					)
			</Constant>
		</Properties>

		<Language>
			<Text id="descResultIntro">
				The coating is composed of nanomachines that strengthen your armor.
			</Text>
		</Language>
	</ItemType>

<!-- BASE CLASSES -->

	<!-- Paste Barrel Item Base Class

	Armor coating barrels should inherit from this class. Typically they should
	set useScreen to dsRPGUseItemOnArmor.

	PROPERTIES

		core.enhancement: Enhancement to apply to armor. Use for constant
			enhancements (i.e., enhancements that apply to all armor).

		rpg.enhancementTable: Table of criteria and enhancements for different 
			armor types / levels. Use this to apply different enhancements to
			different types of armor.

    -->

	<Type UNID="&baStdPasteBarrel;">
		<Properties>
			<Constant id="rpg.useCriteria">"a"</Constant>
		</Properties>

		<Events>
			<CanUseOnItem>
				(block (
					(dstItem (@ gData 'itemToUseOn))
					)
					(switch
						(not (itmMatches dstItem "a"))
							Nil

						(itmIsKnown gItem)
							{
								canUse: True
								desc: (itmTranslate gItem 'descUsageOK {
									useItem: (itmGetName gItem 'article)
									dstItem: (itmGetName dstItem '(demonstrative noModifiers))
									})
								}
						{
							canUse: True
							desc: (itmTranslate gItem 'descUsageUnknown {
								useItem: (itmGetName gItem)
								dstItem: (itmGetName dstItem '(demonstrative noModifiers))
								})
							}
						)
					)
			</CanUseOnItem>

			<GetEnhancement>

				;	This event is called by objCanEnhanceItem and objEnhanceItem
				;	to figure out what enhancement will be applied.
				;
				;	gItem: The item doing the enhancing
				;
				;	gData
				;		targetItem: The item being enhanced.
				;
				;	RETURN
				;		Nil: Cannot enhance target (no effect)
				;		'repair: Target item should be repaired
				;
				;		enhancement description:
				;			enhancement: Enhancement code/desc (required)
				;			lifetime: Duration of enhancement (ticks). Nil or -1
				;				means permanent.
				;			type: Item type of enhancement (only if different
				;				from gItem).
				;			desc: Explanation for result

				(block (
					(dstItem (@ gData 'targetItem))
					enhancement
					enhancementInfo
					)
					(switch

						;	Only works on armor

						(not (itmMatches dstItem "a"))
							Nil

						;	Backwards compatibility

						(setq enhancement (itmGetStaticData gItem 'enhancement))
							{	
								enhancement: enhancement
								}

						;	Table look up
						;	NOTE: It is OK if we find a table entry with no enhancement.
						;	That just means that we cannot enhance the target (usually
						;	due to level) and the desc field explains why.

						(setq enhancementInfo (rpgFindItemInTable dstItem 
								(or (itmGetProperty gItem 'rpg.enhancementTable) 
									(itmGetStaticData gItem 'enhancementTable)
									)
								))
							{
								enhancement: (@ enhancementInfo 'enhancement)
								desc: (or (itmTranslate gItem (@ enhancementInfo 'descID))
										(itmTranslate gItem (cat "descResult" (@ enhancementInfo 'descID)))
										)
								}

						;	Invalid

						Nil
						)
					)
			</GetEnhancement>

			<OnUseOnItem>
				(block (
					(dstItem (@ gData 'itemToUseOn))
					result
					)
					;	Apply the enhancement

					(setq result (objEnhanceItem gPlayerShip dstItem gItem))

					;	Remove and identify the item

					(objRemoveItem gPlayerShip gItem 1)
					(itmSetKnown gItem)

					;	Describe what happened

					{
						desc: (join 
								(list
									(itmTranslate gItem 'descResultIntro)
									(or (@ result 'desc)
										(itmTranslate gItem (cat "descResult." (@ result 'resultCode)))
										)
									)
								" "
								)
						}
					)
			</OnUseOnItem>
		</Events>

		<Language>
			<Text id="descUsageOK">You can use %useItem% on %dstItem%.</Text>
			<Text id="descUsageUnknown">The barrel seems to contain some kind of armor paste. You can use it on %dstItem%.</Text>

			<Text id="descResultTooAdvanced">Unfortunately, your armor is too strong for the nanomachines.</Text>
			<Text id="descResultTooPrimitive">Unfortunately, your armor is too primitive for the nanomachines.</Text>

			<Text id="descResult.alreadyEnhanced">But your armor does not need the enhancement.</Text>
			<Text id="descResult.defectRemoved">It seems to have restored your armor.</Text>
			<Text id="descResult.defectReplaced"></Text>
			<Text id="descResult.degraded">Your armor has weakened further.</Text>
			<Text id="descResult.enhancementRemoved">Your armor has lost its enhancement.</Text>
			<Text id="descResult.enhancementReplaced">Unfortunately, your armor has lost its previous enhancement.</Text>
			<Text id="descResult.improved">Your armor has been further enhanced.</Text>
			<Text id="descResult.noEffect">But it has no effect on your armor.</Text>
		</Language>
	</Type>

</TranscendenceModule>
